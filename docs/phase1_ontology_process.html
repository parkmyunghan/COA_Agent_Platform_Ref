<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase 1 ìƒì„¸ ë¶„ì„: ë°ì´í„° ì¤€ë¹„ ë° ì˜¨í†¨ë¡œì§€ êµ¬ì¶•</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Malgun Gothic', sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #1976D2;
            border-bottom: 2px solid #1976D2;
            padding-bottom: 10px;
        }

        .diagram-box {
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 5px;
            margin-top: 20px;
            overflow-x: auto;
        }

        .description-box {
            background-color: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            line-height: 1.6;
        }

        .code-snippet {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            margin-top: 10px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Phase 1: ë°ì´í„° ì¤€ë¹„ ë° ì˜¨í†¨ë¡œì§€ êµ¬ì¶• ìƒì„¸ í”„ë¡œì„¸ìŠ¤</h1>

        <div class="description-box">
            <h3>ğŸ“Œ í”„ë¡œì„¸ìŠ¤ ê°œìš”</h3>
            <p>
                Phase 1ì€ ì´ê¸°ì¢… ì›ì²œ ë°ì´í„°(Excel, ë¬¸ì„œ)ë¥¼ AIê°€ ì´í•´í•˜ê³  ì¶”ë¡ í•  ìˆ˜ ìˆëŠ” ì§€ì‹ ì•„í‚¤í…ì²˜(Knowledge Graph, Vector DB)ë¡œ ë³€í™˜í•˜ëŠ” í•µì‹¬ ë‹¨ê³„ì…ë‹ˆë‹¤.
                <strong>EnhancedOntologyManager</strong>ì™€ <strong>RAGManager</strong>ê°€ ì´ ê³¼ì •ì˜ í•µì‹¬ ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
            </p>
        </div>

        <div class="diagram-box">
            <div class="mermaid">
                flowchart TD
                %% Input Layer
                subgraph InputLayer ["ğŸ“‚ ì›ì²œ ë°ì´í„° (Source Data)"]
                ExcelFiles[("Excel Tables<br />(15ê°œ íŒŒì¼)")]
                TableDef["ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬<br />(schema_registry.yaml)"]
                RelMap["ê´€ê³„ ë§¤í•‘ ê·œì¹™<br />(relation_mappings.json)"]
                Docs[("ë¹„ì •í˜• ë¬¸ì„œ<br />(TXT 3ê±´)")]
                end

                %% Processing Layer
                subgraph ProcessLayer ["âš™ï¸ ì²˜ë¦¬ ì—”ì§„ (Processing Engine)"]
                direction TB

                subgraph OntoProc ["Ontology Processing (OntologyManager)"]
                LoadData["1. ë°ì´í„° ë¡œë“œ<br />(pd.read_excel)"]
                ParseSchema["2. ìŠ¤í‚¤ë§ˆ íŒŒì‹±<br />(Class/Prop ì •ì˜)"]
                CreateInst["3. ì¸ìŠ¤í„´ìŠ¤ ìƒì„±<br />(URI ë¶€ì—¬, RDF.type)"]
                MapRel["4. ê´€ê³„ ë§¤í•‘<br />(FK & Custom Logic)"]
                Reasoning["5. ì¶”ë¡  (Reasoning)<br />(SPARQL Rule)"]
                end

                subgraph RAGProc ["RAG Processing (RAGManager)"]
                DocLoad["1. ë¬¸ì„œ ë¡œë“œ"]
                Chunking["2. ì²­í‚¹ (Split)"]
                Embedding["3. ì„ë² ë”©<br />(rogel-embedding-v2)"]
                end
                end

                %% Output Layer
                subgraph OutputLayer ["ğŸ’¾ ì§€ì‹ ì €ì¥ì†Œ (Knowledge Storage)"]
                SchemaTTL[("schema.ttl<br />(T-Box)")]
                InstTTL[("instances.ttl<br />(A-Box)")]
                ReasonedTTL[("instances_reasoned.ttl<br />(Inferred)")]
                VectorDB[("Vector DB<br />(FAISS Index)")]
                end

                %% Data Flow Connections
                ExcelFiles -->|"Raw Data"| LoadData
                TableDef -->|"Class/Prop Def"| ParseSchema
                RelMap -->|"Link Rules"| MapRel

                LoadData --> CreateInst
                ParseSchema --> SchemaTTL
                CreateInst --> MapRel
                MapRel --> InstTTL
                InstTTL -.-> Reasoning
                Reasoning --> ReasonedTTL

                Docs --> DocLoad
                DocLoad --> Chunking
                Chunking --> Embedding
                Embedding --> VectorDB

                %% Special Logic Highlighting
                CreateInst --"COA íŠ¹ìˆ˜ì²˜ë¦¬<br />(Keyword->Threat)"--> MapRel

                %% Styling
                classDef input fill:#e1f5fe,stroke:#01579b
                classDef process fill:#fff3e0,stroke:#e65100
                classDef output fill:#e8f5e9,stroke:#1b5e20

                class ExcelFiles,TableDef,RelMap,Docs input
                class LoadData,ParseSchema,CreateInst,MapRel,Reasoning,DocLoad,Chunking,Embedding process
                class SchemaTTL,InstTTL,ReasonedTTL,VectorDB output
            </div>
        </div>

        <div class="description-box" style="background-color: #fff3e0; border-left: 5px solid #ff9800;">
            <h3>ğŸ” ì£¼ìš” ì²˜ë¦¬ ë¡œì§ ìƒì„¸</h3>
            <ul>
                <li><strong>ìŠ¤í‚¤ë§ˆ ìë™ ìƒì„±:</strong> <code>schema_registry.yaml</code>ì„ íŒŒì‹±í•˜ì—¬ RDF Class(í…Œì´ë¸”)ì™€ Property(ì»¬ëŸ¼)ë¥¼
                    ì •ì˜í•©ë‹ˆë‹¤. (T-Box êµ¬ì¶•)</li>
                <li><strong>URI í‘œì¤€í™”:</strong> ê° í–‰(Row)ì˜ ID ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ <code>ns:Table_ID</code> í˜•íƒœì˜ ê³ ìœ  URIë¥¼ ìƒì„±í•©ë‹ˆë‹¤. (15ê°œ ì—‘ì…€
                    í…Œì´ë¸” ì²˜ë¦¬)</li>
                <li><strong>ê´€ê³„ ì—°ê²° (Linking):</strong>
                    <ul>
                        <li><strong>Foreign Key:</strong> ì„ë¬´ID, ì¶•ì„ ID ë“± ëª…ì‹œì  í‚¤ë¥¼ í†µí•œ ì—°ê²° (e.g., <code>hasMission</code>)</li>
                        <li><strong>Semantic Link:</strong> COAì˜ 'í‚¤ì›Œë“œ' ì»¬ëŸ¼ì„ ë¶„ì„í•˜ì—¬ <code>countersThreat</code> ê´€ê³„ë¡œ ìë™ ë³€í™˜
                            (ì „ëµ ì²´ì¸ í˜•ì„±ì˜ í•µì‹¬)</li>
                    </ul>
                </li>
                <li><strong>RAG ì²˜ë¦¬:</strong> 3ê°œì˜ ì‘ì „ ì§€ì¹¨/ê·œì • ë¬¸ì„œë¥¼ ë¡œë“œí•˜ì—¬ ì²­í‚¹ ë° ì„ë² ë”© ì²˜ë¦¬í•©ë‹ˆë‹¤.</li>
            </ul>
        </div>
    </div>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
</body>

</html>