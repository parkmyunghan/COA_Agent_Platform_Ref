<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë° ë°ì´í„° íë¦„ë„</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Malgun Gothic", "ë§‘ì€ ê³ ë”•", Arial, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 100%;
            width: 100%;
            margin: 0 auto;
            background-color: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        @media (max-width: 1200px) {
            .container {
                padding: 20px;
            }
        }

        h1 {
            color: #1976D2;
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 4px solid #1976D2;
            font-size: 32px;
        }

        .diagram-container {
            width: 100%;
            margin: 30px 0;
            padding: 20px;
            background-color: #fafafa;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            position: relative;
            overflow: hidden;
        }

        .mermaid-wrapper {
            width: 100%;
            height: 70vh;
            min-height: 600px;
            overflow: auto;
            cursor: grab;
            position: relative;
            background-color: #f5f5f5;
            border-radius: 8px;
            -webkit-overflow-scrolling: touch;
        }

        .mermaid-wrapper.dragging {
            cursor: grabbing !important;
            user-select: none;
        }

        .mermaid-wrapper:not(.dragging) {
            cursor: grab;
        }

        .mermaid {
            text-align: left;
            font-size: 20px;
            background-color: white;
            padding: 40px;
            border-radius: 8px;
            display: inline-block;
            position: relative;
            min-width: fit-content;
        }

        .mermaid svg {
            display: block;
            width: auto;
            height: auto;
        }

        .zoom-controls {
            position: absolute;
            top: 30px;
            right: 30px;
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .zoom-btn {
            background: #1976D2;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            min-width: 50px;
            transition: background 0.2s;
        }

        .zoom-btn:hover {
            background: #1565C0;
        }

        .zoom-btn:active {
            background: #0D47A1;
        }

        .zoom-info {
            text-align: center;
            padding: 5px;
            font-size: 14px;
            color: #424242;
        }

        .description {
            margin-top: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #f9f9f9 0%, #e8f4f8 100%);
            border-left: 5px solid #1976D2;
            border-radius: 8px;
        }

        .description h2 {
            color: #1976D2;
            margin-bottom: 15px;
            font-size: 24px;
        }

        .description h3 {
            color: #424242;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 20px;
        }

        .description ul {
            line-height: 2;
            margin-left: 20px;
        }

        .description li {
            margin-bottom: 8px;
        }

        .description strong {
            color: #1976D2;
        }

        .tip-box {
            margin-top: 20px;
            padding: 15px;
            background-color: #E3F2FD;
            border-left: 4px solid #1976D2;
            border-radius: 4px;
        }

        .tip-box strong {
            color: #0D47A1;
        }

        /* ì»´í¬ë„ŒíŠ¸ ë§í¬ ì„¹ì…˜ */
        .component-links {
            margin-top: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #fff9e6 0%, #ffe8cc 100%);
            border-left: 5px solid #FF9800;
            border-radius: 8px;
        }

        .component-links h2 {
            color: #FF9800;
            margin-bottom: 15px;
            font-size: 24px;
        }

        .component-links h3 {
            color: #E65100;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 20px;
            padding-bottom: 8px;
            border-bottom: 2px solid #FFB74D;
        }

        .layer-section {
            margin-bottom: 20px;
        }

        .component-list {
            list-style: none;
            padding-left: 0;
            margin: 0;
        }

        .component-list li {
            margin-bottom: 10px;
            padding: 8px 0;
        }

        .component-link {
            display: inline-block;
            padding: 10px 15px;
            background-color: #FFF3E0;
            color: #E65100;
            text-decoration: none;
            border-radius: 5px;
            border: 2px solid #FFB74D;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .component-link:hover {
            background-color: #FFE0B2;
            border-color: #FF9800;
            transform: translateX(5px);
            box-shadow: 0 2px 8px rgba(255, 152, 0, 0.3);
        }

        .component-link:active {
            transform: translateX(3px);
        }

        /* Mermaid ë…¸ë“œ í´ë¦­ ê°€ëŠ¥ ìŠ¤íƒ€ì¼ */
        .mermaid svg .node {
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .mermaid svg .node:hover {
            opacity: 0.8;
        }

        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ë§ */
        .diagram-container::-webkit-scrollbar {
            height: 12px;
        }

        .diagram-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 6px;
        }

        .diagram-container::-webkit-scrollbar-thumb {
            background: #1976D2;
            border-radius: 6px;
        }

        .diagram-container::-webkit-scrollbar-thumb:hover {
            background: #1565C0;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë° ë°ì´í„° íë¦„ë„</h1>

        <div class="diagram-container">
            <div class="zoom-controls">
                <button class="zoom-btn" onclick="zoomIn()" title="í™•ëŒ€">+</button>
                <div class="zoom-info">
                    <span id="zoom-level">100%</span>
                </div>
                <button class="zoom-btn" onclick="zoomOut()" title="ì¶•ì†Œ">-</button>
                <button class="zoom-btn" onclick="resetZoom()" title="ì´ˆê¸°í™”"
                    style="font-size: 14px; padding: 8px;">âŸ²</button>
            </div>
            <div class="mermaid-wrapper" id="mermaid-wrapper">
                <div class="mermaid" id="mermaid-diagram">
                    graph TB
                    subgraph Data["ğŸ—ï¸ ì „ìˆ  ë°ì´í„° ë ˆì´ì–´ (Data Layer)"]
                    direction LR
                    SourceDB[("ì‹¤ì‹œê°„ ì „ìˆ  ë°ì´í„°<br />(16ê°œ ì—‘ì…€ í…Œì´ë¸”)")]
                    Docs[("ë¹„ì •í˜• êµ°ì‚¬ êµë²”<br />(PDF/Text)")]
                    DataMgr[ë°ì´í„° ê´€ë¦¬ì<br />Data Manager]
                    OntoEngine[ì˜¨í†¨ë¡œì§€ ê³ ë„í™” ì—”ì§„]
                    RAGEngine[ì‹œë§¨í‹± ì„ë² ë”© ì—”ì§„]
                    KG[("ì „ìˆ  ì§€ì‹ê·¸ë˜í”„<br />(RDF/TTL)")]
                    VectorDB[("ë²¡í„° ì§€ì‹ë² ì´ìŠ¤<br />(FAISS)<br />êµ°ì‚¬ êµë²” ì„ë² ë”©")]

                    SourceDB -->|ë¡œë“œ| DataMgr
                    DataMgr -->|ì§€í˜•/ë¶€ëŒ€/ìœ„í˜‘| OntoEngine
                    OntoEngine -->|ê´€ê³„ ì¶”ë¡ | KG
                    Docs -->|ì„ë² ë”©| RAGEngine
                    RAGEngine -->|ì €ì¥| VectorDB
                    end

                    subgraph Orchestration["âš™ï¸ ì¸í…”ë¦¬ì „íŠ¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ (API Layer)"]
                    Orchestrator{FastAPI<br />Orchestrator}
                    end

                    subgraph Agents["ğŸ¤– ì§€ëŠ¥í˜• ì—ì´ì „íŠ¸ (Agent Layer)"]
                    direction LR
                    COAAgent[COA ì¶”ì²œ ì—”ì§„<br />EnhancedCOAEngine]
                    LLMMgr[LLM ë§¤ë‹ˆì €]
                    Scorer[ì ì‘í˜• ì ìˆ˜ ê³„ì‚°ê¸°<br />6ëŒ€ í‰ê°€ ìš”ì†Œ]
                    Reasoner[ì‹œë§¨í‹± ì¶”ë¡ ê¸°<br />SPARQL]

                    COAAgent -->|ë°ì´í„° ìš”ì²­| Scorer
                    Scorer -->|í‰ê°€ ì ìˆ˜| COAAgent
                    COAAgent -->|ìƒí™© í•´ì„| LLMMgr
                    LLMMgr -.->|ê·¼ê±° ìƒì„±| COAAgent
                    COAAgent <-->|ì¶”ë¡  ì¿¼ë¦¬| Reasoner
                        end

                        subgraph User["ğŸ‘¤ ì „ìˆ  ìƒí™©ë„ (Command Layer)"]
                        direction LR
                        UserInput[React Tactical Dashboard<br />ìƒí™© ì…ë ¥]
                        ResultView[ë°©ì±… ì¶”ì²œ ì‹œê°í™”<br />MIL-STD-2525]
                        ChainViz[ì „ëµ ì¶”ë¡  ì²´ì¸<br />Graphviz]
                        Feedback[ì§€íœ˜ê´€ í”¼ë“œë°±]

                        UserInput --> ResultView
                        ResultView --> ChainViz
                        end

                        %% ë ˆì´ì–´ ê°„ ì—°ê²°
                        KG -.->|ì§€ì‹ ë² ì´ìŠ¤| Orchestrator
                        Orchestrator -->|ì‘ì „ ìš”ì²­| COAAgent
                        KG -.->|êµë¦¬ ì¶”ë¡ | Reasoner
                        VectorDB -.->|Context| Scorer
                        UserInput ==>|API ìš”ì²­| Orchestrator
                        COAAgent ==>|ìµœì  ë°©ì±…| ResultView
                        Feedback -.->|í•™ìŠµ ë£¨í”„| Orchestrator

                        %% ìŠ¤íƒ€ì¼ ì •ì˜
                        classDef dataLayer fill:#E3F2FD,stroke:#1976D2,stroke-width:3px,color:#0D47A1,font-size:16px
                        classDef agentLayer fill:#F3E5F5,stroke:#7B1FA2,stroke-width:3px,color:#4A148C,font-size:16px
                        classDef userLayer fill:#E8F5E9,stroke:#388E3C,stroke-width:3px,color:#1B5E20,font-size:16px
                        classDef orchestration fill:#ECEFF1,stroke:#546E7A,stroke-width:3px,color:#263238,font-size:16px
                        classDef mainFlow stroke:#388E3C,stroke-width:5px

                        %% ìŠ¤íƒ€ì¼ ì ìš©
                        class SourceDB,Docs,DataMgr,OntoEngine,KG,VectorDB dataLayer
                        class COAAgent,Scorer,Reasoner agentLayer
                        class UserInput,ResultView,ChainViz,Feedback userLayer
                        class Orchestrator orchestration
                        class RAGEngine,LLMMgr orchestration
                        class UserInput,Orchestrator,COAAgent,ResultView mainFlow
                </div>
            </div>
        </div>

        <div class="description">
            <h2>ì‹œìŠ¤í…œ ê°œìš”</h2>
            <p style="font-size: 16px; line-height: 1.8; margin-bottom: 20px;">
                ì´ ë‹¤ì´ì–´ê·¸ë¨ì€ Defense Intelligent Agent Platformì˜ ì „ì²´ ì•„í‚¤í…ì²˜ì™€ ë°ì´í„° íë¦„ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.
                ì‹œìŠ¤í…œì€ 4ê°œì˜ ì£¼ìš” ë ˆì´ì–´ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ê° ë ˆì´ì–´ëŠ” ëª…í™•í•œ ì—­í• ê³¼ ì±…ì„ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.
            </p>

            <h3>ì£¼ìš” êµ¬ì„± ìš”ì†Œ</h3>
            <ul>
                <li><strong>ğŸ—ï¸ Data Layer (ì „ìˆ  ë°ì´í„° ë ˆì´ì–´)</strong>: 16ê°œ í•µì‹¬ ì—‘ì…€ í…Œì´ë¸”ê³¼ êµë²” ë¬¸ì„œë¥¼ ì§€ì‹ê·¸ë˜í”„ì™€ ë²¡í„° ì§€ì‹ë² ì´ìŠ¤ë¡œ ì •ê·œí™”</li>
                <li><strong>âš™ï¸ API Layer (ì¸í…”ë¦¬ì „íŠ¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜)</strong>: FastAPI ê¸°ë°˜ì˜ ì„œë²„ë¡œì„œ ì—ì´ì „íŠ¸ ì„œë¹„ìŠ¤ì™€ ì „ë©´ í”„ë¡ íŠ¸ì—”ë“œ ê°„ì˜ í†µì‹ /ì¡°ìœ¨ ë‹´ë‹¹</li>
                <li><strong>ğŸ¤– Agent Layer (ì§€ëŠ¥í˜• ì—ì´ì „íŠ¸)</strong>: ìƒí™© ë¶„ì„, ë°©ì±… ì¶”ì²œ, ì ì‘í˜• ì ìˆ˜ ê³„ì‚° ë“± í•µì‹¬ ì „ìˆ  ì§€ëŠ¥ ë¡œì§ ìˆ˜í–‰</li>
                <li><strong>ğŸ‘¤ Command Layer (ì „ìˆ  ìƒí™©ë„)</strong>: React ê¸°ë°˜ì˜ í˜„ëŒ€ì  ëŒ€ì‹œë³´ë“œë¥¼ í†µí•´ MIL-STD-2525 ì‹œê°í™” ë° ì§€íœ˜ ê²°ì‹¬ ì§€ì›</li>
            </ul>

            <h3>ë°ì´í„° íë¦„</h3>
            <ul>
                <li><strong>ì‹¤ì„  (â†’)</strong>: ì§ì ‘ì ì¸ ë°ì´í„° íë¦„ ë° ëª¨ë“ˆ ê°„ í˜¸ì¶œ</li>
                <li><strong>ì ì„  (-.->)</strong>: ì‹œë§¨í‹± ì°¸ì¡°, ê·¼ê±° ìƒì„± ë˜ëŠ” ë¹„ë™ê¸° í•™ìŠµ ë£¨í”„</li>
                <li><strong>êµµì€ ì‹¤ì„  (==>)</strong>: ì£¼ ì‘ì „ íë¦„ (ì‚¬ìš©ì ìš”ì²­ â†’ AI ì¶”ë¡  â†’ ì‹œê°í™” ì œì–¸)</li>
            </ul>

            <div class="tip-box">
                <strong>ğŸ’¡ ì‚¬ìš© ë°©ë²•:</strong>
                <ul style="margin-top: 10px; margin-left: 20px;">
                    <li><strong>ë“œë˜ê·¸ ì´ë™:</strong> ë§ˆìš°ìŠ¤ë¡œ ë‹¤ì´ì–´ê·¸ë¨ ë¹ˆ ê³µê°„ì„ í´ë¦­í•˜ê³  ë“œë˜ê·¸í•˜ì—¬ ì´ë™</li>
                    <li><strong>í™•ëŒ€/ì¶•ì†Œ:</strong> Ctrl + ë§ˆìš°ìŠ¤ íœ  ë˜ëŠ” ìš°ì¸¡ ìƒë‹¨ +/- ë²„íŠ¼</li>
                    <li><strong>ì»´í¬ë„ŒíŠ¸ í´ë¦­:</strong> ë‹¤ì´ì–´ê·¸ë¨ì˜ ê° ë…¸ë“œë¥¼ í´ë¦­í•˜ë©´ í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì˜ ìƒì„¸ êµ¬í˜„ ëª…ì„¸(Markdown)ë¡œ ì´ë™í•©ë‹ˆë‹¤.</li>
                </ul>
            </div>
        </div>


        <div class="component-links">
            <h2>ğŸ“š ì»´í¬ë„ŒíŠ¸ ìƒì„¸ ë¬¸ì„œ</h2>
            <p style="font-size: 16px; line-height: 1.8; margin-bottom: 20px;">
                ë‹¤ì´ì–´ê·¸ë¨ì˜ ê° ì»´í¬ë„ŒíŠ¸ë¥¼ í´ë¦­í•˜ê±°ë‚˜ ì•„ë˜ ë§í¬ë¥¼ í†µí•´ ìƒì„¸ ë¬¸ì„œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>

            <div class="layer-section">
                <h3>ğŸ—ï¸ Data Layer</h3>
                <ul class="component-list">
                    <li><a href="20_Components/data_layer/01_ë°ì´í„°ê´€ë¦¬ì.md" target="_blank" class="component-link">ë°ì´í„°ê´€ë¦¬ì
                            (Data Manager)</a></li>
                    <li><a href="20_Components/data_layer/02_ì˜¨í†¨ë¡œì§€ë³€í™˜ê¸°.md" target="_blank" class="component-link">ì˜¨í†¨ë¡œì§€ ê³ ë„í™”
                            ì—”ì§„</a></li>
                    <li><a href="20_Components/data_layer/03_ì„ë² ë”©ì—”ì§„.md" target="_blank" class="component-link">ì‹œë§¨í‹± ì„ë² ë”©
                            ì—”ì§„</a></li>
                    <li><a href="20_Components/data_layer/04_ì§€ì‹ê·¸ë˜í”„.md" target="_blank" class="component-link">ì „ìˆ  ì§€ì‹ê·¸ë˜í”„
                            (RDF/TTL)</a></li>
                    <li><a href="20_Components/data_layer/05_ë²¡í„°DB.md" target="_blank" class="component-link">ë²¡í„° ì§€ì‹ë² ì´ìŠ¤
                            (FAISS)</a></li>
                </ul>
            </div>

            <div class="layer-section">
                <h3>âš™ï¸ API/Orchestration Layer</h3>
                <ul class="component-list">
                    <li><a href="20_Components/orchestration_layer/01_Orchestrator.md" target="_blank"
                            class="component-link">FastAPI Orchestrator</a></li>
                </ul>
            </div>

            <div class="layer-section">
                <h3>ğŸ¤– Agent Layer</h3>
                <ul class="component-list">
                    <li><a href="20_Components/agent_layer/01_COA_ì¶”ì²œ_Agent.md" target="_blank"
                            class="component-link">COA ì¶”ì²œ ì—”ì§„</a></li>
                    <li><a href="20_Components/agent_layer/02_LLM_Manager.md" target="_blank" class="component-link">LLM
                            ë§¤ë‹ˆì €</a></li>
                    <li><a href="20_Components/agent_layer/03_ì ìˆ˜ê³„ì‚°ê¸°.md" target="_blank" class="component-link">ì ì‘í˜• ì ìˆ˜
                            ê³„ì‚°ê¸°</a></li>
                    <li><a href="20_Components/agent_layer/04_ì˜¨í†¨ë¡œì§€ì¶”ë¡ ê¸°.md" target="_blank" class="component-link">ì‹œë§¨í‹± ì¶”ë¡ ê¸°
                            (SPARQL)</a></li>
                </ul>
            </div>

            <div class="layer-section">
                <h3>ğŸ‘¤ Command Layer</h3>
                <ul class="component-list">
                    <li><a href="20_Components/command_layer/01_ìƒí™©ì…ë ¥.md" target="_blank" class="component-link">React
                            Tactical Dashboard</a></li>
                    <li><a href="20_Components/command_layer/02_ë°©ì±…ê²°ê³¼ì‹œê°í™”.md" target="_blank" class="component-link">ë°©ì±…
                            ì‹œê°í™”(MIL-STD-2525)</a></li>
                    <li><a href="20_Components/command_layer/03_ì „ëµì²´ì¸ì‹œê°í™”.md" target="_blank" class="component-link">ì „ëµ ì¶”ë¡ 
                            ì²´ì¸ ì‹œê°í™”</a></li>
                    <li><a href="20_Components/command_layer/04_ì‚¬ìš©ìí”¼ë“œë°±.md" target="_blank" class="component-link">ì§€íœ˜ê´€
                            í”¼ë“œë°± ë£¨í”„</a></li>
                </ul>
            </div>

        </div>

    </div>

    <script>
        // ì»´í¬ë„ŒíŠ¸ ë¬¸ì„œ ë§¤í•‘ (ìƒëŒ€ ê²½ë¡œ)
        const componentDocs = {
            "DataMgr": "20_Components/data_layer/01_ë°ì´í„°ê´€ë¦¬ì.md",
            "OntoEngine": "20_Components/data_layer/02_ì˜¨í†¨ë¡œì§€ë³€í™˜ê¸°.md",
            "RAGEngine": "20_Components/data_layer/03_ì„ë² ë”©ì—”ì§„.md",
            "KG": "20_Components/data_layer/04_ì§€ì‹ê·¸ë˜í”„.md",
            "VectorDB": "20_Components/data_layer/05_ë²¡í„°DB.md",
            "Orchestrator": "20_Components/orchestration_layer/01_Orchestrator.md",
            "COAAgent": "20_Components/agent_layer/01_COA_ì¶”ì²œ_Agent.md",
            "LLMMgr": "20_Components/agent_layer/02_LLM_Manager.md",
            "Scorer": "20_Components/agent_layer/03_ì ìˆ˜ê³„ì‚°ê¸°.md",
            "Reasoner": "20_Components/agent_layer/04_ì˜¨í†¨ë¡œì§€ì¶”ë¡ ê¸°.md",
            "UserInput": "20_Components/command_layer/01_ìƒí™©ì…ë ¥.md",
            "ResultView": "20_Components/command_layer/02_ë°©ì±…ê²°ê³¼ì‹œê°í™”.md",
            "ChainViz": "20_Components/command_layer/03_ì „ëµì²´ì¸ì‹œê°í™”.md",
            "Feedback": "20_Components/command_layer/04_ì‚¬ìš©ìí”¼ë“œë°±.md"
        };

        // ì»´í¬ë„ŒíŠ¸ IDë¥¼ ë…¸ë“œ IDë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
        function getNodeIdFromComponentId(componentId) {
            return componentId;
        }

        // ë¬¸ì„œ ê²½ë¡œë¥¼ ì—´ê¸°
        function openComponentDoc(componentId) {
            if (componentDocs[componentId]) {
                const docRelativePath = componentDocs[componentId];
                // ìƒëŒ€ ê²½ë¡œë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆ ì°½ì—ì„œ ì—´ê¸°
                window.open(docRelativePath, '_blank');
            }
        }

        let currentZoom = 1.0;
        const minZoom = 0.5;
        const maxZoom = 3.0;
        const zoomStep = 0.2;

        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                fontSize: '20px',
                fontFamily: 'Malgun Gothic, ë§‘ì€ ê³ ë”•, Arial, sans-serif',
                primaryColor: '#E3F2FD',
                primaryTextColor: '#0D47A1',
                primaryBorderColor: '#1976D2',
                lineColor: '#757575',
                secondaryColor: '#F3E5F5',
                tertiaryColor: '#E8F5E9'
            },
            flowchart: {
                useMaxWidth: false,
                htmlLabels: true,
                curve: 'basis',
                padding: 20,
                nodeSpacing: 60,
                rankSpacing: 100
            },
            securityLevel: 'loose'
        });

        let baseSvgWidth = null;
        let baseSvgHeight = null;

        function updateZoom() {
            const diagram = document.getElementById('mermaid-diagram');
            const svg = diagram.querySelector('svg');
            if (svg) {
                // ê¸°ë³¸ í¬ê¸° ì €ì¥ (ì²« ë²ˆì§¸ í˜¸ì¶œ ì‹œ)
                if (!baseSvgWidth || !baseSvgHeight) {
                    baseSvgWidth = parseFloat(svg.getAttribute('width')) || svg.viewBox.baseVal.width;
                    baseSvgHeight = parseFloat(svg.getAttribute('height')) || svg.viewBox.baseVal.height;
                }

                // SVG í¬ê¸°ë¥¼ í™•ëŒ€/ì¶•ì†Œ
                const newWidth = baseSvgWidth * currentZoom;
                const newHeight = baseSvgHeight * currentZoom;
                svg.setAttribute('width', newWidth);
                svg.setAttribute('height', newHeight);
                svg.style.width = newWidth + 'px';
                svg.style.height = newHeight + 'px';
            }
            document.getElementById('zoom-level').textContent = Math.round(currentZoom * 100) + '%';
        }

        // Mermaid ë Œë”ë§ ì™„ë£Œ í›„ ì´ˆê¸° í¬ê¸° ì €ì¥ ë° ë…¸ë“œ í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
        function setupDiagram() {
            const diagram = document.getElementById('mermaid-diagram');
            const svg = diagram.querySelector('svg');
            if (svg) {
                // ê¸°ë³¸ í¬ê¸° ì €ì¥
                baseSvgWidth = parseFloat(svg.getAttribute('width')) || svg.viewBox.baseVal.width;
                baseSvgHeight = parseFloat(svg.getAttribute('height')) || svg.viewBox.baseVal.height;

                // SVGê°€ ì›ë˜ í¬ê¸°ë¡œ í‘œì‹œë˜ë„ë¡
                svg.setAttribute('preserveAspectRatio', 'none');
                svg.style.width = baseSvgWidth + 'px';
                svg.style.height = baseSvgHeight + 'px';

                // ë…¸ë“œì— í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
                setupNodeClickEvents(svg);
            }
        }

        // í…ìŠ¤íŠ¸ ê¸°ë°˜ ì»´í¬ë„ŒíŠ¸ ë§¤í•‘ (ë…¸ë“œ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ì„ ë•Œ ì‚¬ìš©)
        const textToComponentMap = {
            'ë°ì´í„°ê´€ë¦¬ì': 'DataMgr',
            'Data Manager': 'DataMgr',
            'ì˜¨í†¨ë¡œì§€ ë³€í™˜ê¸°': 'OntoEngine',
            'ì„ë² ë”© ì—”ì§„': 'RAGEngine',
            'rogel-embedding-v2': 'RAGEngine',
            'ì§€ì‹ê·¸ë˜í”„': 'KG',
            'RDF/TTL': 'KG',
            'ë²¡í„° DB': 'VectorDB',
            'FAISS': 'VectorDB',
            'Orchestrator': 'Orchestrator',
            'Core Pipeline': 'Orchestrator',
            'COA ì¶”ì²œ Agent': 'COAAgent',
            'EnhancedDefenseCOAAgent': 'COAAgent',
            'LLM Manager': 'LLMMgr',
            'ì ìˆ˜ ê³„ì‚°ê¸°': 'Scorer',
            'COA Scorer': 'Scorer',
            'ì˜¨í†¨ë¡œì§€ ì¶”ë¡ ê¸°': 'Reasoner',
            'SPARQL': 'Reasoner',
            'ìƒí™© ì…ë ¥': 'UserInput',
            'Dashboard': 'UserInput',
            'ë°©ì±… ê²°ê³¼ ì‹œê°í™”': 'ResultView',
            'Top 3': 'ResultView',
            'ì „ëµ ì²´ì¸ ì‹œê°í™”': 'ChainViz',
            'Graphviz': 'ChainViz',
            'ì‚¬ìš©ì í”¼ë“œë°±': 'Feedback'
        };

        // í…ìŠ¤íŠ¸ì—ì„œ ì»´í¬ë„ŒíŠ¸ ID ì°¾ê¸°
        function findComponentIdFromText(text) {
            if (!text) return null;
            const normalizedText = text.trim();
            for (const [key, compId] of Object.entries(textToComponentMap)) {
                if (normalizedText.includes(key)) {
                    return compId;
                }
            }
            return null;
        }

        // Mermaid ë…¸ë“œì— í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€ (ì™„ì „íˆ ìƒˆë¡œìš´ ì ‘ê·¼)
        function setupNodeClickEvents(svg) {
            console.log('setupNodeClickEvents ì‹œì‘');

            // ëª¨ë“  ê°€ëŠ¥í•œ ë…¸ë“œ ì„ íƒ
            const allNodes = svg.querySelectorAll('g');
            console.log('ì „ì²´ g ìš”ì†Œ ìˆ˜:', allNodes.length);

            // ë…¸ë“œ IDì™€ ì»´í¬ë„ŒíŠ¸ ë§¤í•‘ ì €ì¥
            const nodeComponentMap = new Map();

            // 1ë‹¨ê³„: ëª¨ë“  ë…¸ë“œë¥¼ ìˆœíšŒí•˜ë©° IDì™€ í…ìŠ¤íŠ¸ ìˆ˜ì§‘
            allNodes.forEach((node, index) => {
                let nodeId = null;
                let nodeText = '';

                // titleì—ì„œ ID ì¶”ì¶œ
                const title = node.querySelector('title');
                if (title) {
                    nodeId = title.textContent.trim();
                }

                // id ì†ì„±ì—ì„œ ì¶”ì¶œ
                if (!nodeId && node.id) {
                    nodeId = node.id.replace(/^flowchart-/, '').replace(/-node$/, '');
                }

                // í…ìŠ¤íŠ¸ ìˆ˜ì§‘
                const textElements = node.querySelectorAll('text');
                textElements.forEach(text => {
                    nodeText += (text.textContent || '') + ' ';
                });
                nodeText = nodeText.trim();

                // í…ìŠ¤íŠ¸ì—ì„œ ì»´í¬ë„ŒíŠ¸ ID ì°¾ê¸°
                if (nodeText) {
                    const foundId = findComponentIdFromText(nodeText);
                    if (foundId && componentDocs[foundId]) {
                        nodeId = foundId;
                    }
                }

                // ë…¸ë“œ IDê°€ ìˆìœ¼ë©´ ë§¤í•‘ì— ì €ì¥
                if (nodeId && componentDocs[nodeId]) {
                    nodeComponentMap.set(node, nodeId);
                    console.log('ë…¸ë“œ ë§¤í•‘:', nodeId, 'í…ìŠ¤íŠ¸:', nodeText.substring(0, 50));
                }
            });

            console.log('ë§¤í•‘ëœ ë…¸ë“œ ìˆ˜:', nodeComponentMap.size);

            // 2ë‹¨ê³„: SVG ì „ì²´ì— í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€ (ì´ë²¤íŠ¸ ìœ„ì„)
            svg.addEventListener('click', function (e) {
                // í´ë¦­ëœ ìš”ì†Œì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ ë…¸ë“œ ì°¾ê¸°
                let target = e.target;
                let clickedNode = null;

                // ìœ„ë¡œ ì˜¬ë¼ê°€ë©° ë…¸ë“œ ì°¾ê¸°
                while (target && target !== svg) {
                    if (nodeComponentMap.has(target)) {
                        clickedNode = target;
                        break;
                    }
                    // ë¶€ëª¨ ë…¸ë“œë„ í™•ì¸
                    if (target.parentElement && nodeComponentMap.has(target.parentElement)) {
                        clickedNode = target.parentElement;
                        break;
                    }
                    target = target.parentElement;
                }

                if (clickedNode) {
                    const componentId = nodeComponentMap.get(clickedNode);
                    console.log('ë…¸ë“œ í´ë¦­ ê°ì§€:', componentId);
                    e.stopPropagation();
                    e.preventDefault();
                    openComponentDoc(componentId);
                    return false;
                }
            }, true); // capture phase

            // 3ë‹¨ê³„: ê° ë…¸ë“œì— í˜¸ë²„ íš¨ê³¼ ì¶”ê°€
            nodeComponentMap.forEach((componentId, node) => {
                node.style.cursor = 'pointer';

                node.addEventListener('mouseenter', function () {
                    node.style.opacity = '0.85';
                    node.style.filter = 'brightness(1.1)';
                });

                node.addEventListener('mouseleave', function () {
                    node.style.opacity = '1';
                    node.style.filter = 'none';
                });
            });

            console.log('setupNodeClickEvents ì™„ë£Œ');
        }

        // Mermaid ë Œë”ë§ ì™„ë£Œ ëŒ€ê¸°
        const checkMermaidReady = setInterval(function () {
            const svg = document.querySelector('#mermaid-diagram svg');
            if (svg && svg.getAttribute('width')) {
                clearInterval(checkMermaidReady);
                setupDiagram();
                // ì¶”ê°€ë¡œ ë…¸ë“œ í´ë¦­ ì´ë²¤íŠ¸ ì¬ì„¤ì • (ë Œë”ë§ ì™„ë£Œ í›„)
                setTimeout(function () {
                    const svg = document.querySelector('#mermaid-diagram svg');
                    if (svg) {
                        setupNodeClickEvents(svg);
                    }
                }, 500);
            }
        }, 100);

        // ìµœëŒ€ 5ì´ˆ í›„ì—ë„ ë Œë”ë§ì´ ì•ˆ ë˜ë©´ ê°•ì œ ì„¤ì •
        setTimeout(function () {
            if (!baseSvgWidth || !baseSvgHeight) {
                setupDiagram();
            }
        }, 5000);

        function zoomIn() {
            if (currentZoom < maxZoom) {
                currentZoom = Math.min(currentZoom + zoomStep, maxZoom);
                updateZoom();
            }
        }

        function zoomOut() {
            if (currentZoom > minZoom) {
                currentZoom = Math.max(currentZoom - zoomStep, minZoom);
                updateZoom();
            }
        }

        function resetZoom() {
            currentZoom = 1.0;
            updateZoom();
            // ìŠ¤í¬ë¡¤ ìœ„ì¹˜ë„ ì´ˆê¸°í™”
            const wrapper = document.getElementById('mermaid-wrapper');
            wrapper.scrollTop = 0;
            wrapper.scrollLeft = 0;
        }

        // ë§ˆìš°ìŠ¤ íœ ë¡œ í™•ëŒ€/ì¶•ì†Œ (Ctrl + íœ )
        const mermaidWrapper = document.getElementById('mermaid-wrapper');
        mermaidWrapper.addEventListener('wheel', function (e) {
            // Ctrl í‚¤ë¥¼ ëˆ„ë¥´ê³  ìˆì„ ë•Œë§Œ í™•ëŒ€/ì¶•ì†Œ
            if (e.ctrlKey) {
                e.preventDefault(); // ë¸Œë¼ìš°ì € ê¸°ë³¸ í™•ëŒ€/ì¶•ì†Œ ë°©ì§€

                // íœ  ë°©í–¥ì— ë”°ë¼ í™•ëŒ€/ì¶•ì†Œ
                if (e.deltaY < 0) {
                    // íœ  ìœ„ë¡œ = í™•ëŒ€
                    zoomIn();
                } else {
                    // íœ  ì•„ë˜ë¡œ = ì¶•ì†Œ
                    zoomOut();
                }
            }
        }, { passive: false });

        // ë“œë˜ê·¸ë¡œ ì´ë™ (Pan) ê¸°ëŠ¥
        let isDragging = false;
        let startX, startY;
        let scrollLeft, scrollTop;
        const wrapper = document.getElementById('mermaid-wrapper');
        const diagram = document.getElementById('mermaid-diagram');

        // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ (ë“œë˜ê·¸)
        wrapper.addEventListener('mousedown', function (e) {
            // í™•ëŒ€/ì¶•ì†Œ ë²„íŠ¼ì´ë‚˜ ë‹¤ë¥¸ ìš”ì†Œ í´ë¦­ ì‹œ ë“œë˜ê·¸ ë°©ì§€
            if (e.target.classList.contains('zoom-btn') ||
                e.target.closest('.zoom-controls') ||
                e.target.tagName === 'BUTTON') {
                return;
            }

            // SVG ë‚´ë¶€ì˜ í…ìŠ¤íŠ¸ë‚˜ ìš”ì†Œ í´ë¦­ë„ í—ˆìš©
            const svgElement = e.target.closest('svg');
            if (svgElement) {
                // ë…¸ë“œ í´ë¦­ì¸ì§€ í™•ì¸ (ë…¸ë“œì˜ textë‚˜ rect, path ë“±ì„ í´ë¦­í•œ ê²½ìš°)
                const isNodeClick = e.target.closest('g.node, g[class*="node"]') ||
                    e.target.tagName === 'text' ||
                    e.target.closest('g') !== null;

                // ë…¸ë“œ í´ë¦­ì´ë©´ ë“œë˜ê·¸ ì‹œì‘í•˜ì§€ ì•ŠìŒ
                if (isNodeClick) {
                    // ì ì‹œ ëŒ€ê¸°í•˜ì—¬ í´ë¦­ ì´ë²¤íŠ¸ê°€ ì²˜ë¦¬ë  ì‹œê°„ì„ ì¤Œ
                    setTimeout(function () {
                        // í´ë¦­ ì´ë²¤íŠ¸ê°€ ì²˜ë¦¬ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ë“œë˜ê·¸ ì‹œì‘
                        if (!e.defaultPrevented) {
                            isDragging = true;
                            wrapper.classList.add('dragging');
                            startX = e.pageX;
                            startY = e.pageY;
                            scrollLeft = wrapper.scrollLeft;
                            scrollTop = wrapper.scrollTop;
                        }
                    }, 100);
                    return;
                }

                isDragging = true;
                wrapper.classList.add('dragging');
                startX = e.pageX;
                startY = e.pageY;
                scrollLeft = wrapper.scrollLeft;
                scrollTop = wrapper.scrollTop;
                e.preventDefault();
                e.stopPropagation();
            }
        });

        document.addEventListener('mousemove', function (e) {
            if (!isDragging) return;
            e.preventDefault();
            e.stopPropagation();
            const x = e.pageX;
            const y = e.pageY;
            const walkX = (startX - x); // ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ ì´ë™
            const walkY = (startY - y);
            wrapper.scrollLeft = scrollLeft + walkX;
            wrapper.scrollTop = scrollTop + walkY;
        });

        document.addEventListener('mouseup', function (e) {
            if (isDragging) {
                isDragging = false;
                wrapper.classList.remove('dragging');
            }
        });

        // í„°ì¹˜ ì´ë²¤íŠ¸ ì§€ì› (ëª¨ë°”ì¼)
        let touchStartX, touchStartY;
        let touchScrollLeft, touchScrollTop;

        wrapper.addEventListener('touchstart', function (e) {
            if (e.target.classList.contains('zoom-btn') ||
                e.target.closest('.zoom-controls') ||
                e.target.tagName === 'BUTTON') {
                return;
            }

            if (e.target.closest('svg') || e.target.closest('.mermaid')) {
                const touch = e.touches[0];
                touchStartX = touch.pageX;
                touchStartY = touch.pageY;
                touchScrollLeft = wrapper.scrollLeft;
                touchScrollTop = wrapper.scrollTop;
                wrapper.classList.add('dragging');
            }
        }, { passive: false });

        wrapper.addEventListener('touchmove', function (e) {
            if (!touchStartX || !touchStartY) return;
            const touch = e.touches[0];
            const walkX = touchStartX - touch.pageX;
            const walkY = touchStartY - touch.pageY;
            wrapper.scrollLeft = touchScrollLeft + walkX;
            wrapper.scrollTop = touchScrollTop + walkY;
            e.preventDefault();
        }, { passive: false });

        wrapper.addEventListener('touchend', function () {
            touchStartX = null;
            touchStartY = null;
            wrapper.classList.remove('dragging');
        }, { passive: true });

        // ë§ˆìš°ìŠ¤ íœ ë¡œ í™•ëŒ€/ì¶•ì†Œ (Ctrl í‚¤ì™€ í•¨ê»˜) ë˜ëŠ” ìŠ¤í¬ë¡¤
        wrapper.addEventListener('wheel', function (e) {
            if (e.ctrlKey || e.metaKey) {
                e.preventDefault();
                if (e.deltaY < 0) {
                    zoomIn();
                } else {
                    zoomOut();
                }
            }
            // Ctrl ì—†ì´ íœ ì„ ëŒë¦¬ë©´ ìŠ¤í¬ë¡¤ (ê¸°ë³¸ ë™ì‘)
        }, { passive: false });

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', function (e) {
            if ((e.ctrlKey || e.metaKey) && e.key === '=') {
                e.preventDefault();
                zoomIn();
            } else if ((e.ctrlKey || e.metaKey) && e.key === '-') {
                e.preventDefault();
                zoomOut();
            } else if ((e.ctrlKey || e.metaKey) && e.key === '0') {
                e.preventDefault();
                resetZoom();
            }
        });
    </script>
</body>

</html>