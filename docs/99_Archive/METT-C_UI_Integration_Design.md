# METT-C UI 통합 설계 문서

**버전**: 1.0  
**작성일**: 2026-01-06  
**최종 수정일**: 2026-01-06

## 목차
1. [기존 UI 구조 분석](#1-기존-ui-구조-분석)
2. [UX 설계 원칙](#2-ux-설계-원칙)
3. [통합 방안](#3-통합-방안)
4. [구현 계획](#4-구현-계획)
5. [사용자 가이드](#5-사용자-가이드)

---

## 1. 기존 UI 구조 분석

### 1.1 점수 표시 컴포넌트

#### `recommendation_visualization.py`
- **역할**: 추천 근거 breakdown 시각화
- **표시 방식**: 
  - 테이블 형식 (DataFrame)
  - 카드 형식 (3열)
  - 차트 시각화 (Plotly)
- **기존 요소**: 6개 (threat, resources, assets, environment, historical, chain)
- **가중치**: threat(0.25), resources(0.20), assets(0.20), environment(0.15), historical(0.10), chain(0.10)

#### `dashboard_tab_situation.py`
- **역할**: 상황 탭에서 상위 3개 방책 표시
- **표시 방식**: 카드 형식, st.metric으로 점수 표시
- **특징**: 간결한 요약 정보

#### `palantir_mode_toggle.py`
- **역할**: 팔란티어 모드 점수 breakdown
- **표시 방식**: 3열 메트릭 (st.metric)
- **특징**: 컴팩트한 표시

#### `decision_support.py`
- **역할**: 의사결정 지원 breakdown
- **표시 방식**: 테이블 형식
- **특징**: 6개 요소만 표시

### 1.2 데이터 구조

```python
score_breakdown = {
    'threat': 0.8,
    'resources': 0.7,
    'assets': 0.6,
    'environment': 0.75,
    'historical': 0.8,
    'chain': 0.3,
    'mission_alignment': 0.76  # 기존에 있음
}

# NEW: METT-C 점수
mett_c = {
    'mission': 0.94,
    'enemy': 0.80,
    'terrain': 0.705,
    'troops': 0.65,
    'civilian': 0.22,  # NEW
    'time': 0.70,      # NEW
    'total': 0.689
}
```

---

## 2. UX 설계 원칙

### 2.1 핵심 원칙

1. **기존 UI 패턴 유지**: 사용자가 익숙한 레이아웃과 스타일 유지
2. **점진적 정보 공개**: 기본 정보 먼저, 상세 정보는 확장 가능한 섹션에
3. **명확한 구분**: 기존 점수와 METT-C 점수를 시각적으로 구분
4. **컨텍스트 제공**: 각 요소에 대한 설명과 도움말 제공
5. **반응형 디자인**: 다양한 화면 크기에 대응

### 2.2 정보 계층 구조

```
Level 1: 종합 점수 (기존)
  └─ Level 2: 기존 6개 요소 breakdown
  └─ Level 2: METT-C 종합 점수 (NEW)
      └─ Level 3: METT-C 6개 요소 breakdown (NEW)
```

### 2.3 시각적 구분

- **기존 점수**: 기본 스타일 (회색/파란색 계열)
- **METT-C 점수**: 별도 섹션, 강조 색상 (녹색/주황색 계열)
- **민간인/시간 요소**: 특별 표시 (경고 아이콘, 주의 색상)

---

## 3. 통합 방안

### 3.1 통합 전략

#### 전략 1: 확장 가능한 섹션 (권장)
- 기존 breakdown 유지
- METT-C 점수를 별도 확장 가능한 섹션에 표시
- 사용자가 필요시에만 확장하여 확인

#### 전략 2: 통합 테이블
- 기존 6개 요소 + METT-C 6개 요소를 하나의 테이블에 표시
- 카테고리 구분 (기존 평가 / METT-C 평가)

#### 전략 3: 탭 분리
- "기본 평가" 탭과 "METT-C 평가" 탭으로 분리
- 각 탭에서 상세 정보 확인

**선택: 전략 1 (확장 가능한 섹션)**
- 기존 UI 최소 변경
- 사용자 혼란 최소화
- 점진적 정보 공개

### 3.2 레이아웃 설계

```
┌─────────────────────────────────────────┐
│ 📊 추천 근거 분석                        │
├─────────────────────────────────────────┤
│ [기존 6개 요소 breakdown]                │
│ - 테이블                                 │
│ - 카드 (3열)                             │
│ - 차트                                   │
├─────────────────────────────────────────┤
│ ▼ METT-C 종합 평가 (확장 가능)          │
│   └─ [확장 시]                           │
│      - METT-C 종합 점수                  │
│      - 6개 요소 breakdown                 │
│      - 민간인 보호 상세                   │
│      - 시간 제약 상세                     │
└─────────────────────────────────────────┘
```

### 3.3 컴포넌트별 통합 방안

#### `recommendation_visualization.py`
- 기존 breakdown 유지
- METT-C 섹션 추가 (확장 가능)
- 민간인/시간 요소 특별 표시

#### `dashboard_tab_situation.py`
- 기존 카드 유지
- METT-C 점수 배지 추가 (선택적)
- 민간인/시간 경고 표시

#### `palantir_mode_toggle.py`
- 기존 3열 메트릭 유지
- METT-C 메트릭 추가 (4열로 확장 또는 별도 섹션)

#### `decision_support.py`
- 기존 테이블 유지
- METT-C 테이블 추가 (확장 가능)

---

## 4. 구현 계획

### 4.1 Phase 1: recommendation_visualization.py 확장

**작업 내용**:
1. METT-C 점수 섹션 추가
2. 민간인 보호 상세 표시
3. 시간 제약 상세 표시
4. 차트에 METT-C 요소 추가

**예상 시간**: 2시간

### 4.2 Phase 2: dashboard_tab_situation.py 확장

**작업 내용**:
1. METT-C 점수 배지 추가
2. 민간인/시간 경고 표시
3. 확장 가능한 METT-C 상세 섹션

**예상 시간**: 1시간

### 4.3 Phase 3: palantir_mode_toggle.py 확장

**작업 내용**:
1. METT-C 메트릭 추가
2. 레이아웃 조정 (4열 또는 별도 섹션)

**예상 시간**: 1시간

### 4.4 Phase 4: decision_support.py 확장

**작업 내용**:
1. METT-C 테이블 추가
2. 통합 비교 기능

**예상 시간**: 1시간

### 4.5 Phase 5: 리포트 생성 기능

**작업 내용**:
1. METT-C 분석 리포트 생성
2. PDF/HTML 형식 지원

**예상 시간**: 2시간

---

## 5. 사용자 가이드

### 5.1 METT-C 점수 이해하기

**METT-C 요소**:
- **M (Mission)**: 임무 부합성
- **E (Enemy)**: 적군 대응 능력
- **T (Terrain)**: 지형 적합성
- **T (Troops)**: 부대 능력
- **C (Civilian)**: 민간인 보호 (NEW)
- **C (Time)**: 시간 제약 준수 (NEW)

### 5.2 민간인 보호 점수 해석

- **0.8 이상**: 매우 우수 (민간인 지역 영향 없음)
- **0.5-0.8**: 양호 (최소한의 영향)
- **0.3-0.5**: 보통 (일부 영향, 주의 필요)
- **0.3 미만**: 부족 (민간인 지역에 큰 영향, 방책 재검토 필요)

### 5.3 시간 제약 점수 해석

- **0.8 이상**: 매우 우수 (시간 여유 있음)
- **0.5-0.8**: 양호 (시간 제약 준수)
- **0.0**: 위반 (시간 제약 초과, 방책 실행 불가)

---

## 6. 시각적 디자인 가이드

### 6.1 색상 체계

- **기존 점수**: `#636e72` (회색)
- **METT-C 점수**: `#00b894` (녹색)
- **민간인 경고**: `#e17055` (주황색)
- **시간 위반**: `#d63031` (빨간색)

### 6.2 아이콘

- **Mission**: 🎯
- **Enemy**: ⚠️
- **Terrain**: 🌍
- **Troops**: 👥
- **Civilian**: 🏘️ (NEW)
- **Time**: ⏰ (NEW)

### 6.3 배지 스타일

```python
# 민간인 보호 점수 낮을 때
if civilian_score < 0.3:
    st.warning("⚠️ 민간인 보호 점수 낮음")
    
# 시간 제약 위반 시
if time_score == 0.0:
    st.error("❌ 시간 제약 위반")
```

---

## 7. 검증 포인트

### 7.1 기능 검증
- [ ] METT-C 점수가 정상 표시되는가?
- [ ] 민간인/시간 요소가 특별히 강조되는가?
- [ ] 기존 UI와 충돌하지 않는가?
- [ ] 확장/축소가 정상 작동하는가?

### 7.2 UX 검증
- [ ] 사용자가 혼란스럽지 않은가?
- [ ] 정보가 과도하지 않은가?
- [ ] 중요한 정보가 눈에 띄는가?
- [ ] 모바일에서도 사용 가능한가?

---

## 변경 이력

| 날짜 | 버전 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 2026-01-06 | 1.0 | 초기 설계 문서 작성 | System |
| 2026-01-06 | 1.1 | Phase 1-5 구현 완료 | System |

---

## 8. 구현 완료 내역

### Phase 1: recommendation_visualization.py 확장 ✅
- [x] METT-C 점수 섹션 추가 (확장 가능한 섹션)
- [x] 민간인 보호 상세 표시 (점수 낮을 때 경고)
- [x] 시간 제약 상세 표시 (위반 시 경고)
- [x] METT-C 차트 시각화 추가
- [x] 요소별 상세 카드 표시

### Phase 2: dashboard_tab_situation.py 확장 ✅
- [x] METT-C 점수 배지 추가
- [x] 민간인/시간 경고 표시
- [x] 확장 가능한 METT-C 상세 섹션

### Phase 3: palantir_mode_toggle.py 확장 ✅
- [x] METT-C 메트릭 추가 (4열 레이아웃)
- [x] 민간인/시간 경고 표시

### Phase 4: decision_support.py 확장 ✅
- [x] METT-C 테이블 추가
- [x] 경고 메시지 표시

### Phase 5: 리포트 생성 기능 ✅
- [x] PDF 리포트에 METT-C 섹션 추가
- [x] Excel 리포트에 METT-C 섹션 추가
- [x] 민간인/시간 경고 표시

---

## 9. 사용자 가이드

### 9.1 METT-C 점수 확인 방법

1. **추천 근거 분석 페이지**:
   - "METT-C 종합 평가" 섹션을 확장하여 확인
   - 민간인 보호 점수 < 0.3이면 경고 표시
   - 시간 제약 위반 시 경고 표시

2. **상황 탭**:
   - 각 방책 카드에 METT-C 점수 배지 표시
   - 경고 아이콘으로 민간인/시간 문제 표시

3. **팔란티어 모드**:
   - 점수 breakdown에 METT-C 메트릭 추가
   - 4열 레이아웃으로 표시

4. **의사결정 지원**:
   - 기존 breakdown 테이블 아래에 METT-C 테이블 추가

### 9.2 리포트 생성

- **PDF 리포트**: METT-C 섹션이 자동으로 포함됨
- **Excel 리포트**: METT-C 시트가 자동으로 추가됨
- **민간인/시간 경고**: 리포트에 자동으로 표시됨

---

## 10. 검증 포인트

### 10.1 기능 검증
- [x] METT-C 점수가 정상 표시되는가?
- [x] 민간인/시간 요소가 특별히 강조되는가?
- [x] 기존 UI와 충돌하지 않는가?
- [x] 확장/축소가 정상 작동하는가?

### 10.2 UX 검증
- [x] 사용자가 혼란스럽지 않은가? (확장 가능한 섹션으로 해결)
- [x] 정보가 과도하지 않은가? (기본은 축소, 필요시 확장)
- [x] 중요한 정보가 눈에 띄는가? (경고 아이콘 및 색상 사용)
- [x] 모바일에서도 사용 가능한가? (반응형 레이아웃)

---

## 11. 주요 개선 사항

### 11.1 사용자 경험 개선
1. **점진적 정보 공개**: 기본 정보 먼저, 상세 정보는 확장 가능한 섹션에
2. **시각적 구분**: METT-C 점수를 녹색 배경으로 구분
3. **경고 표시**: 민간인/시간 문제를 명확히 표시
4. **컨텍스트 제공**: 각 요소에 대한 설명과 도움말 제공

### 11.2 기존 시스템과의 통합
1. **최소 변경**: 기존 UI 패턴 유지
2. **하위 호환성**: METT-C 점수가 없어도 정상 작동
3. **일관성**: 모든 컴포넌트에서 동일한 스타일 적용

