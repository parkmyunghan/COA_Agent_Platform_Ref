# 로그 출력 옵션 가이드

**작성일**: 2025-12-22  
**목적**: 시스템 로그 출력 옵션 및 사용 방법 안내

---

## 📋 목차

1. [로그 출력 옵션 개요](#1-로그-출력-옵션-개요)
2. [명령줄 옵션](#2-명령줄-옵션)
3. [환경 변수 설정](#3-환경-변수-설정)
4. [로그 파일 위치](#4-로그-파일-위치)
5. [로그 레벨 설정](#5-로그-레벨-설정)
6. [로그 사용 예시](#6-로그-사용-예시)

---

## 1. 로그 출력 옵션 개요

시스템은 두 가지 로그 출력 방식을 지원합니다:

1. **콘솔 출력** (기본): 항상 활성화
2. **파일 출력** (선택): `--log-to-file` 옵션으로 활성화

**기본 동작**: 파일 로깅은 **비활성화**되어 있습니다 (성능 최적화)

---

## 2. 명령줄 옵션

### 2.1 기본 실행 (파일 로깅 비활성화)

```powershell
python run_streamlit.py
```

**출력**:
```
>> [INFO] 파일 로깅 비활성화됨 (속도 최적화)
```

### 2.2 파일 로깅 활성화

```powershell
python run_streamlit.py --log-to-file
```

**출력**:
```
>> [INFO] 파일 로깅 활성화됨
```

### 2.3 다른 옵션과 함께 사용

```powershell
# COA Agent 앱 + 파일 로깅
python run_streamlit.py --app coa --log-to-file

# 포트 지정 + 파일 로깅
python run_streamlit.py --port 8502 --log-to-file
```

---

## 3. 환경 변수 설정

### 3.1 환경 변수로 제어

파일 로깅은 환경 변수 `COA_LOG_TO_FILE`로 제어됩니다:

```powershell
# 파일 로깅 활성화
$env:COA_LOG_TO_FILE = "true"
python run_streamlit.py

# 파일 로깅 비활성화
$env:COA_LOG_TO_FILE = "false"
python run_streamlit.py
```

### 3.2 영구 설정 (선택사항)

시스템 환경 변수로 설정하려면:

```powershell
# 사용자 환경 변수 설정
[System.Environment]::SetEnvironmentVariable("COA_LOG_TO_FILE", "true", "User")

# 시스템 환경 변수 설정 (관리자 권한 필요)
[System.Environment]::SetEnvironmentVariable("COA_LOG_TO_FILE", "true", "Machine")
```

---

## 4. 로그 파일 위치

### 4.1 로그 파일 경로

로그 파일은 `logs/` 디렉토리에 저장됩니다:

```
COA_Agent_Platform/
└── logs/
    ├── system_YYYYMMDD.log    # 날짜별 시스템 로그
    └── error.log              # 에러 전용 로그
```

### 4.2 로그 파일 형식

**시스템 로그** (`system_YYYYMMDD.log`):
```
2025-12-22 13:30:45 - [INFO] 시스템 초기화 시작
2025-12-22 13:30:46 - [WARN] 타일 서버 연결 실패
2025-12-22 13:30:47 - [ERROR] 타일 로드 실패
```

**에러 로그** (`error.log`):
```
2025-12-22 13:30:47 - [LOG_ERROR] 로그 파일 쓰기 실패: ...
2025-12-22 13:30:47 - [LOG_ERROR] 원본 메시지: ...
```

---

## 5. 로그 레벨 설정

### 5.1 설정 파일

`config/global.yaml`에서 로그 레벨을 설정할 수 있습니다:

```yaml
# 로그 설정
log_level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
log_path: "./logs"
```

### 5.2 지원하는 로그 레벨

| 레벨 | 설명 | 출력 |
|------|------|------|
| **DEBUG** | 상세 디버깅 정보 | 개발/디버깅 시 |
| **INFO** | 일반 정보 | 기본값 |
| **WARNING** | 경고 메시지 | 문제 가능성 |
| **ERROR** | 에러 메시지 | 오류 발생 |
| **CRITICAL** | 치명적 오류 | 시스템 중단 |

---

## 6. 로그 사용 예시

### 6.1 코드에서 로그 사용

#### Python 로거 사용

```python
from common.logger import get_logger

logger = get_logger("MyComponent")
logger.info("정보 메시지")
logger.warning("경고 메시지")
logger.error("에러 메시지")
logger.debug("디버그 메시지")
```

#### safe_print 사용

```python
from common.utils import safe_print

# 콘솔 + 파일 로깅 (환경 변수에 따라)
safe_print("[INFO] 메시지", also_log_file=True, logger_name="MyComponent")

# 콘솔만 (파일 로깅 안 함)
safe_print("[INFO] 메시지", also_log_file=False)
```

### 6.2 실행 예시

#### 예시 1: 파일 로깅 활성화하여 실행

```powershell
# 파일 로깅 활성화
python run_streamlit.py --log-to-file

# 로그 파일 확인
Get-Content logs/system_20251222.log -Tail 50
```

#### 예시 2: 에러 로그 확인

```powershell
# 에러 로그 확인
Get-Content logs/error.log -Tail 20
```

#### 예시 3: 실시간 로그 모니터링

```powershell
# 실시간 로그 모니터링 (PowerShell)
Get-Content logs/system_20251222.log -Wait -Tail 10
```

---

## 7. 로그 파일 관리

### 7.1 로그 파일 크기

- **시스템 로그**: 날짜별로 자동 분리 (`system_YYYYMMDD.log`)
- **에러 로그**: 단일 파일 (`error.log`)

### 7.2 로그 파일 정리

```powershell
# 오래된 로그 파일 삭제 (30일 이상)
Get-ChildItem logs/system_*.log | Where-Object {$_.LastWriteTime -lt (Get-Date).AddDays(-30)} | Remove-Item

# 에러 로그 백업 후 초기화
Copy-Item logs/error.log logs/error_backup_$(Get-Date -Format 'yyyyMMdd').log
Clear-Content logs/error.log
```

---

## 8. 성능 고려사항

### 8.1 파일 로깅 비활성화 권장

**기본적으로 파일 로깅은 비활성화**되어 있습니다:

- ✅ **성능 최적화**: 디스크 I/O 감소
- ✅ **속도 향상**: 로그 파일 쓰기 오버헤드 제거
- ✅ **메모리 효율**: 로그 버퍼링 최소화

### 8.2 파일 로깅 활성화 시기

다음 경우에만 파일 로깅을 활성화하세요:

- 🔍 **디버깅**: 문제 발생 시 상세 로그 필요
- 📊 **분석**: 시스템 동작 분석 필요
- 🐛 **에러 추적**: 에러 재현 및 분석
- 📝 **감사**: 시스템 사용 기록 보관

---

## 9. 문제 해결

### 9.1 로그 파일이 생성되지 않는 경우

**원인**: 파일 로깅이 비활성화되어 있음

**해결**:
```powershell
# 파일 로깅 활성화
python run_streamlit.py --log-to-file
```

### 9.2 로그 파일에 쓰기 권한이 없는 경우

**원인**: `logs/` 디렉토리 권한 문제

**해결**:
```powershell
# logs 디렉토리 권한 확인
Get-Acl logs

# 필요시 권한 수정
icacls logs /grant Users:F
```

### 9.3 로그 파일이 너무 큰 경우

**원인**: 장시간 실행 또는 과도한 로깅

**해결**:
- 로그 파일 정리 (7.2 참조)
- 로그 레벨을 `INFO` 또는 `WARNING`으로 상향 조정
- 파일 로깅 비활성화

---

## 10. 요약

### 빠른 참조

| 작업 | 명령어 |
|------|--------|
| **기본 실행** (파일 로깅 없음) | `python run_streamlit.py` |
| **파일 로깅 활성화** | `python run_streamlit.py --log-to-file` |
| **로그 파일 확인** | `Get-Content logs/system_YYYYMMDD.log` |
| **에러 로그 확인** | `Get-Content logs/error.log` |
| **실시간 모니터링** | `Get-Content logs/system_YYYYMMDD.log -Wait` |

### 주요 설정

- **파일 로깅**: `--log-to-file` 옵션 또는 `COA_LOG_TO_FILE=true` 환경 변수
- **로그 레벨**: `config/global.yaml`의 `log_level` 설정
- **로그 위치**: `logs/` 디렉토리

---

**작성자**: AI Assistant  
**최종 수정**: 2025-12-22  
**버전**: 1.0

# 로그 출력 옵션 가이드

**작성일**: 2025-12-22  
**목적**: 시스템 로그 출력 옵션 및 사용 방법 안내

---

## 📋 목차

1. [로그 출력 옵션 개요](#1-로그-출력-옵션-개요)
2. [명령줄 옵션](#2-명령줄-옵션)
3. [환경 변수 설정](#3-환경-변수-설정)
4. [로그 파일 위치](#4-로그-파일-위치)
5. [로그 레벨 설정](#5-로그-레벨-설정)
6. [로그 사용 예시](#6-로그-사용-예시)

---

## 1. 로그 출력 옵션 개요

시스템은 두 가지 로그 출력 방식을 지원합니다:

1. **콘솔 출력** (기본): 항상 활성화
2. **파일 출력** (선택): `--log-to-file` 옵션으로 활성화

**기본 동작**: 파일 로깅은 **비활성화**되어 있습니다 (성능 최적화)

---

## 2. 명령줄 옵션

### 2.1 기본 실행 (파일 로깅 비활성화)

```powershell
python run_streamlit.py
```

**출력**:
```
>> [INFO] 파일 로깅 비활성화됨 (속도 최적화)
```

### 2.2 파일 로깅 활성화

```powershell
python run_streamlit.py --log-to-file
```

**출력**:
```
>> [INFO] 파일 로깅 활성화됨
```

### 2.3 다른 옵션과 함께 사용

```powershell
# COA Agent 앱 + 파일 로깅
python run_streamlit.py --app coa --log-to-file

# 포트 지정 + 파일 로깅
python run_streamlit.py --port 8502 --log-to-file
```

---

## 3. 환경 변수 설정

### 3.1 환경 변수로 제어

파일 로깅은 환경 변수 `COA_LOG_TO_FILE`로 제어됩니다:

```powershell
# 파일 로깅 활성화
$env:COA_LOG_TO_FILE = "true"
python run_streamlit.py

# 파일 로깅 비활성화
$env:COA_LOG_TO_FILE = "false"
python run_streamlit.py
```

### 3.2 영구 설정 (선택사항)

시스템 환경 변수로 설정하려면:

```powershell
# 사용자 환경 변수 설정
[System.Environment]::SetEnvironmentVariable("COA_LOG_TO_FILE", "true", "User")

# 시스템 환경 변수 설정 (관리자 권한 필요)
[System.Environment]::SetEnvironmentVariable("COA_LOG_TO_FILE", "true", "Machine")
```

---

## 4. 로그 파일 위치

### 4.1 로그 파일 경로

로그 파일은 `logs/` 디렉토리에 저장됩니다:

```
COA_Agent_Platform/
└── logs/
    ├── system_YYYYMMDD.log    # 날짜별 시스템 로그
    └── error.log              # 에러 전용 로그
```

### 4.2 로그 파일 형식

**시스템 로그** (`system_YYYYMMDD.log`):
```
2025-12-22 13:30:45 - [INFO] 시스템 초기화 시작
2025-12-22 13:30:46 - [WARN] 타일 서버 연결 실패
2025-12-22 13:30:47 - [ERROR] 타일 로드 실패
```

**에러 로그** (`error.log`):
```
2025-12-22 13:30:47 - [LOG_ERROR] 로그 파일 쓰기 실패: ...
2025-12-22 13:30:47 - [LOG_ERROR] 원본 메시지: ...
```

---

## 5. 로그 레벨 설정

### 5.1 설정 파일

`config/global.yaml`에서 로그 레벨을 설정할 수 있습니다:

```yaml
# 로그 설정
log_level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
log_path: "./logs"
```

### 5.2 지원하는 로그 레벨

| 레벨 | 설명 | 출력 |
|------|------|------|
| **DEBUG** | 상세 디버깅 정보 | 개발/디버깅 시 |
| **INFO** | 일반 정보 | 기본값 |
| **WARNING** | 경고 메시지 | 문제 가능성 |
| **ERROR** | 에러 메시지 | 오류 발생 |
| **CRITICAL** | 치명적 오류 | 시스템 중단 |

---

## 6. 로그 사용 예시

### 6.1 코드에서 로그 사용

#### Python 로거 사용

```python
from common.logger import get_logger

logger = get_logger("MyComponent")
logger.info("정보 메시지")
logger.warning("경고 메시지")
logger.error("에러 메시지")
logger.debug("디버그 메시지")
```

#### safe_print 사용

```python
from common.utils import safe_print

# 콘솔 + 파일 로깅 (환경 변수에 따라)
safe_print("[INFO] 메시지", also_log_file=True, logger_name="MyComponent")

# 콘솔만 (파일 로깅 안 함)
safe_print("[INFO] 메시지", also_log_file=False)
```

### 6.2 실행 예시

#### 예시 1: 파일 로깅 활성화하여 실행

```powershell
# 파일 로깅 활성화
python run_streamlit.py --log-to-file

# 로그 파일 확인
Get-Content logs/system_20251222.log -Tail 50
```

#### 예시 2: 에러 로그 확인

```powershell
# 에러 로그 확인
Get-Content logs/error.log -Tail 20
```

#### 예시 3: 실시간 로그 모니터링

```powershell
# 실시간 로그 모니터링 (PowerShell)
Get-Content logs/system_20251222.log -Wait -Tail 10
```

---

## 7. 로그 파일 관리

### 7.1 로그 파일 크기

- **시스템 로그**: 날짜별로 자동 분리 (`system_YYYYMMDD.log`)
- **에러 로그**: 단일 파일 (`error.log`)

### 7.2 로그 파일 정리

```powershell
# 오래된 로그 파일 삭제 (30일 이상)
Get-ChildItem logs/system_*.log | Where-Object {$_.LastWriteTime -lt (Get-Date).AddDays(-30)} | Remove-Item

# 에러 로그 백업 후 초기화
Copy-Item logs/error.log logs/error_backup_$(Get-Date -Format 'yyyyMMdd').log
Clear-Content logs/error.log
```

---

## 8. 성능 고려사항

### 8.1 파일 로깅 비활성화 권장

**기본적으로 파일 로깅은 비활성화**되어 있습니다:

- ✅ **성능 최적화**: 디스크 I/O 감소
- ✅ **속도 향상**: 로그 파일 쓰기 오버헤드 제거
- ✅ **메모리 효율**: 로그 버퍼링 최소화

### 8.2 파일 로깅 활성화 시기

다음 경우에만 파일 로깅을 활성화하세요:

- 🔍 **디버깅**: 문제 발생 시 상세 로그 필요
- 📊 **분석**: 시스템 동작 분석 필요
- 🐛 **에러 추적**: 에러 재현 및 분석
- 📝 **감사**: 시스템 사용 기록 보관

---

## 9. 문제 해결

### 9.1 로그 파일이 생성되지 않는 경우

**원인**: 파일 로깅이 비활성화되어 있음

**해결**:
```powershell
# 파일 로깅 활성화
python run_streamlit.py --log-to-file
```

### 9.2 로그 파일에 쓰기 권한이 없는 경우

**원인**: `logs/` 디렉토리 권한 문제

**해결**:
```powershell
# logs 디렉토리 권한 확인
Get-Acl logs

# 필요시 권한 수정
icacls logs /grant Users:F
```

### 9.3 로그 파일이 너무 큰 경우

**원인**: 장시간 실행 또는 과도한 로깅

**해결**:
- 로그 파일 정리 (7.2 참조)
- 로그 레벨을 `INFO` 또는 `WARNING`으로 상향 조정
- 파일 로깅 비활성화

---

## 10. 요약

### 빠른 참조

| 작업 | 명령어 |
|------|--------|
| **기본 실행** (파일 로깅 없음) | `python run_streamlit.py` |
| **파일 로깅 활성화** | `python run_streamlit.py --log-to-file` |
| **로그 파일 확인** | `Get-Content logs/system_YYYYMMDD.log` |
| **에러 로그 확인** | `Get-Content logs/error.log` |
| **실시간 모니터링** | `Get-Content logs/system_YYYYMMDD.log -Wait` |

### 주요 설정

- **파일 로깅**: `--log-to-file` 옵션 또는 `COA_LOG_TO_FILE=true` 환경 변수
- **로그 레벨**: `config/global.yaml`의 `log_level` 설정
- **로그 위치**: `logs/` 디렉토리

---

**작성자**: AI Assistant  
**최종 수정**: 2025-12-22  
**버전**: 1.0






