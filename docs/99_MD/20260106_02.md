# 📘 RAG 기반 교리–COA 연계 설계 패키지

*(METT-C 반영 이후 단계)*

---

## 전체 흐름 요약 (중요)

```text
[교리/교범 가상 생성]
        ↓
[RAG 문서화 + 메타데이터 부여]
        ↓
[COA 추천 시 RAG 인용]
        ↓
[“왜 이 COA인가?” 설명 생성]
```

이 3가지는 **분리 불가**이며,
**①의 출력 품질이 ②·③의 품질을 결정**합니다.

---

## 1️⃣ RAG용 교리 문서 자동 생성 프롬프트 세트

### 1-1. 설계 원칙 (Cursor AI에 반드시 명시)

* 실제 교범을 **요약하거나 모방하지 말 것**
* **교리 ‘형식’과 ‘논리 구조’만 재현**
* RAG 검색·인용을 전제로 **문장 단위로 쪼개기**
* METT-C / COA 판단에 직접 쓰일 수 있는 문장만 생성

---

### 1-2. RAG 문서 구조 표준 (MD 기준)

```md
# Doctrine_ID: DOCTRINE-XXX
## 교리명
## 적용 작전유형
## 관련 METT-C 요소
## 교리 원문 문장
## 작전적 해석
## COA 판단 시 활용 포인트
```

---

### 1-3. 교리 문서 자동 생성용 프롬프트 (핵심)

```text
너는 군사 교리 집필 보조 AI이다.

목표:
- 실제 교범을 인용하거나 요약하지 말고,
- "군 교리 문장 형식"을 따르는 가상 교리 문서를 생성하라.
- 생성된 문서는 RAG 시스템에 저장되어
  COA 추천 시 근거 문장으로 사용된다.

생성 규칙:
1. 각 교리 문장은 단문·명시적 판단 기준 형태로 작성
2. 하나의 문장은 하나의 작전 판단 논리만 포함
3. METT-C 요소 중 최소 1개 이상을 명시적으로 언급
4. "권장된다 / 고려한다 / 제한된다" 와 같은 규범적 표현 사용
5. 역사적 사례, 실제 교범 명칭, 실존 문서 언급 금지

출력 형식:
- MD 형식
- 각 교리 문장은 고유 ID 부여

생성 대상:
- 작전유형: [예: 방어작전]
- METT-C 중점: [Mission, Terrain, Troops]
- COA 활용 목적: [기동 제한, 방어선 설정, 예비전력 운용]

이제 교리 문서를 생성하라.
```

---

### 1-4. 생성 예시 (일부)

```md
### Doctrine_Statement_ID: D-DEF-001
- 적 주공축이 제한된 지형을 통해 예상될 경우,
  방어 COA는 지형 차단선을 중심으로 구성되는 것이 권장된다.
```

→ **이 문장 자체가 RAG 인용 단위**

---

## 2️⃣ COA 추천 시 RAG 문서 인용 / 근거 표시 포맷

### 2-1. 설계 핵심 원칙

* “AI 판단”이 아니라 **“교리 근거 기반 판단”으로 보이게**
* RAG는 **판단 주체가 아닌 근거 제공자**
* METT-C → COA → 교리 문장 연결이 명확해야 함

---

### 2-2. COA 추천 결과 표준 포맷 (JSON / UI 공통)

```json
{
  "coa_id": "COA-02",
  "recommendation_level": "HIGH",
  "mett_c_alignment": {
    "mission": "방어선 유지",
    "terrain": "협소한 접근로",
    "troops": "기동부대 제한"
  },
  "doctrine_references": [
    {
      "doctrine_id": "DOCTRINE-DEF",
      "statement_id": "D-DEF-001",
      "excerpt": "적 주공축이 제한된 지형을 통해 예상될 경우..."
    }
  ]
}
```

---

### 2-3. Cursor AI용 COA 추천 프롬프트 (중요)

```text
COA를 추천할 때는 반드시 다음을 수행하라.

1. METT-C 분석 결과를 먼저 제시
2. COA 추천 판단은 교리 문장에 의해 뒷받침되어야 한다
3. 모든 추천 COA에는 최소 1개 이상의 교리 문장 ID를 포함하라
4. 교리 문장이 없는 판단은 '추론'으로 분리 표기하라
5. 교리 문장을 임의로 생성하거나 수정하지 말고 RAG 결과만 인용하라
```

---

## 3️⃣ “이 COA는 어떤 교리 문장을 근거로 추천되었는가?” 설명 구조

### 3-1. 설명 구조 표준 (보고서·UI 공용)

```md
### COA-02 추천 근거 설명

1. 작전 상황 요약
2. METT-C 핵심 제약 요소
3. 적용된 교리 문장
4. 교리 → COA 연결 논리
5. 교리 미적용 영역 (있을 경우)
```

---

### 3-2. 실제 출력 예시

```md
### COA-02 추천 근거

본 COA는 방어 작전 상황에서 적의 주공 방향이
지형적으로 제한된다는 판단에 근거하여 추천되었다.

- METT-C 분석 결과, 접근로는 협소하며 우회 기동은 제한됨
- 이에 따라 교리 문장 D-DEF-001이 적용됨

[D-DEF-001]
“적 주공축이 제한된 지형을 통해 예상될 경우,
방어 COA는 지형 차단선을 중심으로 구성되는 것이 권장된다.”

본 COA는 해당 교리에 따라 차단선 중심 방어선을 설정하고,
예비 전력은 후방에 배치하는 구조로 구성되었다.
```

---

### 3-3. 중요한 안전장치 문장 (필수)

```md
본 설명은 교리 문장을 근거로 한 추천 논리를 제시하는 것이며,
최종 작전 결정은 지휘관 판단에 따른다.
```

→ **실제 군사 시스템 보고서 톤과 일치**

---

## 4. 이 3가지를 함께 진행하는 것이 “왜” 효과적인가

| 항목    | 이유                          |
| ----- | --------------------------- |
| ① → ② | 교리 문장 단위가 곧 COA 인용 단위       |
| ② → ③ | 인용 구조가 있어야 설명 가능            |
| ③     | “AI 추천”이 아닌 “교리 기반 판단”으로 격상 |

👉 **하나라도 빠지면 시스템 신뢰도가 급락**

