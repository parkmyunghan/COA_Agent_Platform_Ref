# 상황 입력 (Dashboard)

## 1. 개요

- **역할**: 사용자로부터 상황 정보 입력 받기
- **위치**: Command Layer
- **컴포넌트**: `ui.components.situation_input`
- **다이어그램 표시**: "상황 입력 (Dashboard)"

상황 입력은 사용자가 위협 상황이나 임무 정보를 입력하는 사용자 인터페이스입니다. 4가지 입력 방식을 지원하여 다양한 상황에서 유연하게 사용할 수 있습니다.

---

## 2. 주요 기능

### 2.1 접근 방식 선택
- **위협 중심**: 방어 작전 (위협상황이 먼저 보고된 경우)
- **임무 중심**: 공격 작전 (상급 부대에서 임무가 부여된 경우)

### 2.2 입력 방식 (4가지)
1. **실제 데이터에서 선택**: Excel 파일의 미리 정의된 시나리오 선택
2. **SITREP 텍스트 입력**: 상황보고 텍스트를 입력하여 자동 파싱
3. **수동 입력**: 사용자가 직접 위협 정보 입력
4. **데모 시나리오**: 사전 구성된 시나리오 로드

### 2.3 상황 정보 구성
- 위협 ID, 위협 유형, 심각도
- 임무 ID, 임무 유형
- 가용 자산 정보
- 접근 방식 (approach_mode)

---

## 3. 구현 상세

### 3.1 컴포넌트 위치
```python
# ui/components/situation_input.py
def render_situation_input(orchestrator=None, use_real_data: bool = True):
    """상황 입력 UI 렌더링"""
```

### 3.2 주요 함수

#### `render_situation_input(orchestrator, use_real_data) -> Dict`
상황 입력 UI를 렌더링하고 상황 정보를 반환합니다.

```python
# 사용 예시
situation_info = render_situation_input(
    orchestrator=orchestrator,
    use_real_data=True
)
# 결과: {
#     "situation_id": "THR001",
#     "위협유형": "침투",
#     "심각도": 85,
#     "threat_level": 0.85,
#     "approach_mode": "threat_centered",
#     ...
# }
```

---

## 4. 데이터 흐름

```
사용자 입력
    ↓
입력 방식 선택
    ├─→ 실제 데이터 선택
    │   └─→ Excel 파일에서 로드
    ├─→ SITREP 텍스트 입력
    │   └─→ LLM 파싱 (선택적)
    ├─→ 수동 입력
    │   └─→ 사용자 직접 입력
    └─→ 데모 시나리오
        └─→ 사전 구성 시나리오
    ↓
상황 정보 딕셔너리 생성
    ↓
session_state에 저장
    ↓
Agent에 전달
```

---

## 5. 설정 및 파라미터

### 5.1 입력 필드
- **위협 중심**:
  - 위협 ID, 위협 유형, 심각도
  - 가용 자산 정보
  - 위치 정보

- **임무 중심**:
  - 임무 ID, 임무 유형
  - 작전축 정보
  - 가용 자산 정보

### 5.2 접근 방식
- **threat_centered**: 위협 중심 접근
- **mission_centered**: 임무 중심 접근

---

## 6. 사용 예시

### 6.1 기본 사용
```python
# ui/components/dashboard_tab_situation.py
situation_info = render_situation_input(
    orchestrator=orchestrator,
    use_real_data=True
)

if situation_info:
    # Agent 실행
    agent_result = agent.execute_reasoning(
        situation_id=situation_info.get("situation_id"),
        selected_situation_info=situation_info
    )
```

### 6.2 SITREP 입력
```python
# SITREP 텍스트 입력
sitrep_text = """
적 전차부대가 동부 주공축선쪽으로 공격해 오고 있음.
위협수준 높음. 아군 기갑여단 1개 대대 가용.
"""
# LLM을 통한 자동 파싱 (선택적)
```

---

## 7. 관련 컴포넌트

### 7.1 입력
- **사용자**: 상황 정보 입력
- **Excel 파일**: 미리 정의된 시나리오

### 7.2 출력
- **Agent**: 상황 정보 전달
- **Orchestrator**: 요청 처리

---

## 8. 참고 자료

- **코드 위치**: `ui/components/situation_input.py`
- **관련 문서**: 
  - `docs/사용자_가이드.md`
- **데이터 파일**: 
  - `data_lake/위협상황.xlsx`
  - `data_lake/임무정보.xlsx`
  - `data_lake/시나리오모음.xlsx`

---

**작성일**: 2025년 12월  
**버전**: 1.0

