# ì „ëµ ì²´ì¸ ì‹œê°í™” (Graphviz)

## 1. ê°œìš”

- **ì—­í• **: ìœ„í˜‘(Threat)ì—ì„œ ë°©ì±…(COA)ê¹Œì§€ì˜ ê´€ê³„ ê²½ë¡œë¥¼ Graphvizë¡œ ì‹œê°í™”
- **ìœ„ì¹˜**: Command Layer
- **í´ë˜ìŠ¤**: `ui.components.chain_visualizer.ChainVisualizer`
- **ë‹¤ì´ì–´ê·¸ë¨ í‘œì‹œ**: "ì „ëµ ì²´ì¸ ì‹œê°í™” (Graphviz)"

ì „ëµ ì²´ì¸ ì‹œê°í™”ëŠ” ì˜¨í†¨ë¡œì§€ ê·¸ë˜í”„ì—ì„œ ë°œê²¬ëœ ê´€ê³„ ì²´ì¸ì„ ì‹œê°ì ìœ¼ë¡œ í‘œí˜„í•˜ì—¬, ì™œ íŠ¹ì • ë°©ì±…ì´ ì¶”ì²œë˜ì—ˆëŠ”ì§€ì˜ ë…¼ë¦¬ì  ê²½ë¡œë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. ì´ëŠ” "Palantir ë°©ì‹"ì˜ ì‹œê°ì  ì¶”ë¡ (Visual Reasoning)ì„ êµ¬í˜„í•œ ê¸°ëŠ¥ì…ë‹ˆë‹¤.

---

## 2. ì£¼ìš” ê¸°ëŠ¥

### 2.1 ê´€ê³„ ì²´ì¸ íƒìƒ‰
- ì˜¨í†¨ë¡œì§€ ê·¸ë˜í”„ì—ì„œ ìœ„í˜‘ â†’ ìì‚° â†’ ìœ„ì¹˜ â†’ ë°©ì±… ê°™ì€ ë‹¤ë‹¨ê³„ ê´€ê³„ ê²½ë¡œ íƒìƒ‰
- BFS ì•Œê³ ë¦¬ì¦˜ ê¸°ë°˜ ì²´ì¸ ë°œê²¬
- ìµœëŒ€ ê¹Šì´ ë° ê²½ë¡œ ìˆ˜ ì œí•œ

### 2.2 Graphviz ì‹œê°í™”
- ìœ„í˜‘ ë…¸ë“œ: ë¹¨ê°„ìƒ‰ ì´ì¤‘ ì›
- ë°©ì±… ë…¸ë“œ: íŒŒë€ìƒ‰ ë°•ìŠ¤
- ì¤‘ê°„ ë…¸ë“œ: íšŒìƒ‰ ë°•ìŠ¤
- í™”ì‚´í‘œ: ê´€ê³„(predicate) í‘œì‹œ

### 2.3 ë©”íŠ¸ë¦­ í‘œì‹œ
- ì´ ì²´ì¸ ìˆ˜
- í‰ê·  ê¹Šì´
- í‰ê·  ì ìˆ˜

---

## 3. êµ¬í˜„ ìƒì„¸

### 3.1 í´ë˜ìŠ¤ ìœ„ì¹˜
```python
# ui/components/chain_visualizer.py
class ChainVisualizer:
    """
    Dynamic Chain of Strategy Visualizer
    Renders relationship chains from Threat to COA using Graphviz
    """
```

### 3.2 ì£¼ìš” ë©”ì„œë“œ

#### `render_chains(chain_info: Dict, expanded: bool = True)`
ì²´ì¸ ì •ë³´ë¥¼ Graphvizë¡œ ë Œë”ë§í•©ë‹ˆë‹¤.

```python
# ì‚¬ìš© ì˜ˆì‹œ
from ui.components.chain_visualizer import ChainVisualizer

visualizer = ChainVisualizer()
visualizer.render_chains(chain_info)
```

### 3.3 ì²´ì¸ ì •ë³´ êµ¬ì¡°
```python
chain_info = {
    "chains": [
        {
            "path": [threat_uri, asset_uri, location_uri, coa_uri],
            "predicates": ["hasThreat", "locatedIn", "countersThreat"],
            "score": 0.85,
            "depth": 3
        },
        # ...
    ],
    "summary": {
        "total_chains": 5,
        "avg_depth": 2.8,
        "avg_score": 0.82
    }
}
```

---

## 4. ë°ì´í„° íë¦„

```
ì˜¨í†¨ë¡œì§€ ì¶”ë¡ ê¸° (ReasoningEngine)
    â†“
RelationshipChain.find_coa_chains()
    â†“
BFS ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ê²½ë¡œ íƒìƒ‰
    â†“
ì²´ì¸ ì •ë³´ ìƒì„±
    â†“
ChainVisualizer.render_chains()
    â†“
Graphviz DOT ì½”ë“œ ìƒì„±
    â†“
Streamlit Graphviz Chart ë Œë”ë§
    â†“
ì‚¬ìš©ìì—ê²Œ ì‹œê°í™” í‘œì‹œ
```

---

## 5. ì„¤ì • ë° íŒŒë¼ë¯¸í„°

### 5.1 RelationshipChain ì„¤ì •
```python
# core_pipeline/relationship_chain.py
config = {
    "max_chain_depth": 3,  # ìµœëŒ€ íƒìƒ‰ ê¹Šì´
    "max_paths": 10        # ìµœëŒ€ ê²½ë¡œ ìˆ˜
}
```

### 5.2 Graphviz ìŠ¤íƒ€ì¼
```python
# ë…¸ë“œ ìŠ¤íƒ€ì¼
- ìœ„í˜‘: ë¹¨ê°„ìƒ‰ ì´ì¤‘ ì› (doublecircle)
- ë°©ì±…: íŒŒë€ìƒ‰ ë°•ìŠ¤ (box)
- ì¤‘ê°„: íšŒìƒ‰ ë°•ìŠ¤ (box, rounded)
```

---

## 6. ì‚¬ìš© ì˜ˆì‹œ

### 6.1 Agentì—ì„œ ì²´ì¸ ê³„ì‚°
```python
# agents/defense_coa_agent/logic_defense_enhanced.py
chain_info = self._calculate_chain_info(strategy, situation_info)
```

### 6.2 UIì—ì„œ ì‹œê°í™”
```python
# ui/views/agent_execution.py
from ui.components.chain_visualizer import ChainVisualizer

if chain_info:
    ChainVisualizer().render_chains(chain_info)
```

### 6.3 ì‹œê°í™” ê²°ê³¼ ì˜ˆì‹œ
```
ğŸ”— ì „ëµ ì—°ê²° ì²´ì¸ (Dynamic Chain of Strategy) - 5 paths found

[ë©”íŠ¸ë¦­]
Total Chains: 5
Avg Depth: 2.8
Avg Score: 0.82

[Graphviz ë‹¤ì´ì–´ê·¸ë¨]
ìœ„í˜‘(ë¹¨ê°„ìƒ‰) â†’ ìì‚°(íšŒìƒ‰) â†’ ìœ„ì¹˜(íšŒìƒ‰) â†’ ë°©ì±…(íŒŒë€ìƒ‰)
```

---

## 7. ê´€ë ¨ ì»´í¬ë„ŒíŠ¸

### 7.1 ì…ë ¥
- **ì˜¨í†¨ë¡œì§€ ì¶”ë¡ ê¸°**: ê´€ê³„ ì²´ì¸ íƒìƒ‰ ê²°ê³¼
- **ë°©ì±… ê²°ê³¼ ì‹œê°í™”**: ì²´ì¸ ì •ë³´ í¬í•¨ëœ ì¶”ì²œ ê²°ê³¼

### 7.2 ì¶œë ¥
- **ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤**: Streamlit Graphviz Chart
- **ì‚¬ìš©ì í”¼ë“œë°±**: ì²´ì¸ ì •ë³´ë¥¼ í†µí•œ ì¶”ì²œ ê·¼ê±° ì´í•´

### 7.3 ì˜ì¡´ì„±
- **RelationshipChain**: `core_pipeline/relationship_chain.py`
- **Graphviz**: Python `graphviz` ë¼ì´ë¸ŒëŸ¬ë¦¬
- **ì˜¨í†¨ë¡œì§€ ê·¸ë˜í”„**: RDF ê·¸ë˜í”„ ë°ì´í„°

---

## 8. ì°¸ê³  ìë£Œ

- **ì½”ë“œ ìœ„ì¹˜**: 
  - `ui/components/chain_visualizer.py`
  - `core_pipeline/relationship_chain.py`
- **ê´€ë ¨ ë¬¸ì„œ**: 
  - `docs/ì‹œìŠ¤í…œ_ì•„í‚¤í…ì²˜.md`
  - `docs/ë°©ì±…ì¶”ì²œ_ì‹œìŠ¤í…œ.md`
- **Graphviz ë¬¸ì„œ**: https://graphviz.org/

---

## 9. ëª©ì  ë° íš¨ê³¼

### 9.1 ì¶”ì²œ ê·¼ê±° ì œê³µ
- ë‹¨ìˆœíˆ ì ìˆ˜ë§Œ ì œì‹œí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ê´€ê³„ ê²½ë¡œë¥¼ í†µí•´ **ì™œ** í•´ë‹¹ ë°©ì±…ì´ ì¶”ì²œë˜ì—ˆëŠ”ì§€ ì„¤ëª…

### 9.2 íˆ¬ëª…ì„± í–¥ìƒ
- ì¶”ë¡  ê³¼ì •ì„ ì‹œê°ì ìœ¼ë¡œ í™•ì¸ ê°€ëŠ¥
- ì§€íœ˜ê´€ì´ ì¶”ì²œ ê·¼ê±°ë¥¼ ì´í•´í•˜ê³  íŒë‹¨ ê°€ëŠ¥

### 9.3 ì˜ì‚¬ê²°ì • ì§€ì›
- ê´€ê³„ ì²´ì¸ì„ í†µí•´ ë°©ì±…ì˜ ë…¼ë¦¬ì  ì—°ê²° í™•ì¸
- ì‹ ë¢°ì„± ìˆëŠ” ì˜ì‚¬ê²°ì • ì§€ì›

---

**ì‘ì„±ì¼**: 2025ë…„ 12ì›”  
**ë²„ì „**: 1.0

