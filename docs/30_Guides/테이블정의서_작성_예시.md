# 테이블정의서 작성 예시

## 표준 구조

엑셀 파일의 두 번째 시트에 다음 구조로 작성합니다.

### 컬럼 헤더 (첫 번째 행)

| 필드명 | 타입 | 설명 | FK | 관계 |
|--------|------|------|----|----|

**참고**: 컬럼명은 다음 중 하나로 인식됩니다:
- 필드명: `필드명`, `Field`, `컬럼`, `Column` (필드, field, 컬럼 포함)
- 타입: `타입`, `Type`, `데이터타입` (타입, type 포함)
- 설명: `설명`, `Description`, `Desc` (설명, description, desc 포함)
- FK: `FK`, `fk` (정확히 FK 또는 fk)
- 관계: `관계`, `Relation` (관계, relation 포함)

---

## 예시 1: 아군부대현황

| 필드명 | 타입 | 설명 | FK | 관계 |
|--------|------|------|----|----|
| 아군부대ID | string | PK, FRU001 | N | - |
| 부대명 | string | 부대의 공식 명칭 | N | - |
| 제대 | string | 사단/여단 | N | - |
| 병종 | string | 보병/기계화/기갑 | N | - |
| 전투력지수 | int | 0~100 | N | - |
| 배치축선ID | string | 현재/계획 배치 축선 | Y | 전장축선:축선ID |
| 배치지형셀ID | string | 실제 위치 지형셀 | Y | 지형셀:지형셀ID |
| 가용상태 | string | 가용/손실/이동중 | N | - |
| 임무역할 | string | 주공/조공/예비 | N | - |
| 비고 | string | 추가 설명 | N | - |

---

## 예시 2: 위협상황

| 필드명 | 타입 | 설명 | FK | 관계 |
|--------|------|------|----|----|
| 위협ID | string | PK | N | - |
| 발생시각 | datetime | 위협 발생 시각 | N | - |
| 위협유형코드 | string | 침투/기습공격/포병준비/상륙/공중위협/기만징후 | N | - |
| 관련축선ID | string | 위협이 영향을 미치는 작전축선 | Y | 전장축선:축선ID |
| 발생위치셀ID | string | 위협 발생 지점의 지형셀 | Y | 지형셀:지형셀ID |
| 관련_적부대ID | string | 관측된/추정되는 적 부대 | Y | 적군부대현황:적군부대ID |
| 위협수준 | string | High/Medium/Low 또는 1~5 | N | - |
| 관련임무ID | string | 해당 위협이 연관된 임무 | Y | 임무정보:임무ID |
| 원시보고텍스트 | text | 상황보고(SITREP) 원문 | N | - |

---

## 예시 3: 지형셀

| 필드명 | 타입 | 설명 | FK | 관계 |
|--------|------|------|----|----|
| 지형셀ID | string | PK, TERR003 | N | - |
| 지형명 | string | 321고지 등 | N | - |
| 지형유형 | string | 산악/평지/도시 | N | - |
| 기동성등급 | int | 1~5 (1:우수, 5:불량) | N | - |
| 방어유리도 | int | 1~5 | N | - |
| 관측유리도 | int | 1~5 | N | - |
| 요충지여부 | string | Y/N | N | - |

---

## 작성 규칙 요약

### 1. Primary Key (PK)
- **형식**: 설명 컬럼에 `PK` 또는 `PK, [값]` 표기
- **예시**: `PK`, `PK, FRU001`, `PK, TERR003`
- **효과**: 자동으로 필수 컬럼으로 인식, 고유성 검증

### 2. Foreign Key (FK)
- **FK 컬럼**: `Y`, `YES`, `TRUE`, `1`, `예`, `O` 중 하나로 표기
- **관계 컬럼**: `[테이블명]:[컬럼명]` 형식으로 작성 (콜론 구분 권장)
- **예시**: 
  - FK 컬럼: `Y`
  - 관계 컬럼: `전장축선:축선ID` ✅ (권장)
  - 관계 컬럼: `지형셀:지형셀ID` ✅ (권장)
  - 관계 컬럼: `전장축선.축선ID` ✅ (점 구분도 지원)
- **효과**: 참조 무결성 검증, 온톨로지 Property 자동 생성

### 3. 값 범위
- **형식**: 설명 컬럼에 `[최소값]~[최대값]` 또는 `[최소값]-[최대값]`
- **예시**: `0~100`, `1-5`
- **효과**: 범위를 벗어난 값 검출

### 4. 열거형 (Enum)
- **형식**: 설명 컬럼에 `값1/값2/값3` (슬래시로 구분)
- **예시**: 
  - `가용/손실/이동중`
  - `High/Medium/Low`
  - `사단/여단`
  - `Y/N`
- **효과**: 허용되지 않은 값 검출

### 5. 필수 컬럼
- **형식**: 설명 컬럼에 `필수` 또는 `NOT NULL` 표기
- **예시**: `필수`, `NOT NULL`
- **효과**: NULL 값 검증

### 6. 데이터 타입
- **지원 타입**: `string`, `int`, `float`, `datetime`, `text`
- **효과**: 데이터 타입 검증

---

## 체크리스트

테이블정의서 작성 시 다음을 확인하세요:

- [ ] 시트명이 `테이블정의서`, `정의서`, 또는 `Schema`인가?
- [ ] 필드명 컬럼이 첫 번째 행에 있는가?
- [ ] 필드명이 실제 데이터 테이블의 컬럼명과 정확히 일치하는가?
- [ ] 모든 행에 타입이 명시되어 있는가?
- [ ] PK 컬럼에 설명에 `PK` 표기가 있는가?
- [ ] FK 컬럼에 `Y`로 표기되어 있는가?
- [ ] FK가 Y인 경우, 관계 컬럼에 `테이블명:컬럼명` 형식으로 작성되어 있는가?
- [ ] 값 범위가 `0~100` 형식으로 표기되어 있는가?
- [ ] 열거형 값이 `/`로 구분되어 있는가?

---

## 주의사항

1. **필드명 일치**: 테이블정의서의 필드명은 반드시 실제 데이터 테이블의 컬럼명과 일치해야 합니다.

2. **FK 관계 작성**: 
   - FK 컬럼에 Y를 표시했으면 **반드시 관계 컬럼에 관계 정보를 작성**해야 합니다
   - 관계 형식은 `테이블명:컬럼명` (콜론 구분)을 권장합니다
   - 예: `전장축선:축선ID`

3. **대소문자 구분**: PK, FK 표기는 대소문자를 구분하지 않지만, 일관성을 위해 대문자 사용을 권장합니다.

4. **특수문자**: 값 범위는 `~` 또는 `-`를 사용하고, 열거형은 `/`를 사용합니다.

5. **온톨로지 반영**: 테이블정의서를 수정한 후에는 **2단계: 온톨로지 생성** 페이지에서 "그래프 생성" 버튼을 클릭하여 변경 사항을 반영해야 합니다.

---

## FK 관계 작성 예시

### ✅ 올바른 예시

| 필드명 | 타입 | 설명 | FK | 관계 |
|--------|------|------|----|----|
| 배치축선ID | string | 현재/계획 배치 축선 | Y | 전장축선:축선ID |
| 배치지형셀ID | string | 실제 위치 지형셀 | Y | 지형셀:지형셀ID |

### ❌ 잘못된 예시

| 필드명 | 타입 | 설명 | FK | 관계 |
|--------|------|------|----|----|
| 배치축선ID | string | 현재/계획 배치 축선 | Y | (비어있음) ❌ |
| 배치지형셀ID | string | 실제 위치 지형셀 | (없음) | 지형셀:지형셀ID ❌ |

**문제점**:
- 첫 번째: FK가 Y인데 관계 컬럼이 비어있음 → 관계가 생성되지 않음
- 두 번째: FK 컬럼이 없음 → 관계가 인식되지 않음
