# RAG ê¸°ë°˜ êµë¦¬Â·êµë²” í™œìš© ê°œì„  êµ¬í˜„ ìš”ì•½

## êµ¬í˜„ ì¼ìž
2026-01-06

## êµ¬í˜„ ì™„ë£Œ í•­ëª© (ìš°ì„ ìˆœìœ„ 1: ì¦‰ì‹œ ì‹¤í–‰)

### âœ… 1. ì ìš©ì¡°ê±´ í•„ë“œ ë‹¨ìˆœí™”
**ë³€ê²½ ì‚¬í•­**:
- `metadata/schema_registry.yaml`: `ì ìš©ì¡°ê±´` í•„ë“œ íƒ€ìž…ì„ `expression` â†’ `list`ë¡œ ë³€ê²½
- `core_pipeline/ontology_manager_enhanced.py`: 
  - `_extract_keywords_from_condition()` ë©”ì„œë“œ ì¶”ê°€
  - ì ìš©ì¡°ê±´ expressionì„ í‚¤ì›Œë“œ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜í•˜ëŠ” ë¡œì§ êµ¬í˜„
  - ì˜ˆ: `"threat_level > 0.8"` â†’ `["ê³ ìœ„í˜‘"]`

**í‚¤ì›Œë“œ ë§¤í•‘ í…Œì´ë¸”**:
- `threat_level > 0.8` â†’ `["ê³ ìœ„í˜‘"]`
- `penetration == True` â†’ `["ì¹¨íˆ¬"]`
- `resources < 0.5` â†’ `["ìžì›ë¶€ì¡±"]`
- ê¸°íƒ€ 10ê°œ ì´ìƒì˜ íŒ¨í„´ ë§¤í•‘

### âœ… 2. ì ëŒ€ì‘ì „ìˆ  í•„ë“œ ì œê±°
**ë³€ê²½ ì‚¬í•­**:
- `metadata/schema_registry.yaml`: `ì ëŒ€ì‘ì „ìˆ ` í•„ë“œ ì œê±° (ì£¼ì„ ì²˜ë¦¬)
- `core_pipeline/ontology_manager_enhanced.py`: 
  - `_process_coa_library_relations()` ë©”ì„œë“œì—ì„œ ì ëŒ€ì‘ì „ìˆ  ì²˜ë¦¬ ë¡œì§ ì œê±°
  - ì£¼ì„ ì¶”ê°€: "RAG ë¬¸ì„œë¡œ ì´ë™"

**ëŒ€ì²´ ë°©ì•ˆ**:
- RAG ë¬¸ì„œ `ì _ëŒ€ì‘ì „ìˆ _ë¶„ì„_ê°€ì´ë“œ.txt` ìƒì„±
- ì  ëŒ€ì‘ì „ìˆ  ì„¤ëª… ë° ëŒ€ì‘ ë°©ì•ˆì„ RAGë¡œ ê²€ìƒ‰ ê°€ëŠ¥

### âœ… 3. ì—°ê³„ë°©ì±… ì„œìˆ í˜• í•„ë“œ ì œê±°
**ë³€ê²½ ì‚¬í•­**:
- `metadata/schema_registry.yaml`: `ì—°ê³„ë°©ì±…` í•„ë“œ ì œê±° (ì£¼ì„ ì²˜ë¦¬)
- `core_pipeline/ontology_manager_enhanced.py`: 
  - `_process_coa_library_relations()` ë©”ì„œë“œì—ì„œ ì—°ê³„ë°©ì±… ì„œìˆ í˜• í•„ë“œ ì²˜ë¦¬ ì œê±°
  - `hasRelatedCOA` ê´€ê³„ëŠ” ìœ ì§€ (SPARQL ì§ˆì˜ì— í•„ìš”)

**ëŒ€ì²´ ë°©ì•ˆ**:
- RAG ë¬¸ì„œ `ë°©ì±…_ì—°ê³„_ì›ì¹™.txt` ìƒì„±
- ì—°ê³„ ë°©ì±… ì„ íƒ ê¸°ì¤€ì„ RAGë¡œ ê²€ìƒ‰ ê°€ëŠ¥

### âœ… 4. RAG ë¬¸ì„œ ì¶”ê°€ (5ê°œ)
**ì¶”ê°€ëœ ë¬¸ì„œ**:
1. `COA_ì ìš©ì¡°ê±´_í•´ì„_ê°€ì´ë“œ.txt` - ì ìš©ì¡°ê±´ í•´ì„ ê¸°ì¤€
2. `ì _ëŒ€ì‘ì „ìˆ _ë¶„ì„_ê°€ì´ë“œ.txt` - ì  ëŒ€ì‘ì „ìˆ  ë¶„ì„ ë° ëŒ€ì‘ ë°©ì•ˆ
3. `ë°©ì±…_ì—°ê³„_ì›ì¹™.txt` - ë°©ì±… ì—°ê³„ ì›ì¹™ ë° ì„ ì • ê¸°ì¤€
4. `ì§€íœ˜ê´€_ì˜ë„_í•´ì„_ê°€ì´ë“œ.txt` - ì§€íœ˜ê´€ ì˜ë„ í•´ì„ ë°©ë²•
5. `í™˜ê²½_ì¡°ê±´_í•´ì„_ê°€ì´ë“œ.txt` - í™˜ê²½ ì¡°ê±´ í•´ì„ ê¸°ì¤€

**í˜„ìž¬ RAG ë¬¸ì„œ í˜„í™©**:
- ì´ 8ê°œ ë¬¸ì„œ (ê¸°ì¡´ 3ê°œ + ì‹ ê·œ 5ê°œ)
  - `ìž‘ì „_ë°©ì±…ì„ ì •_ì§€ì¹¨.txt` (ê¸°ì¡´)
  - `ROE_ë°_ì œì•½ì¡°ê±´.txt` (ê¸°ì¡´)
  - `í†µì‹ _ë³´ê¸‰_ì²´í¬ë¦¬ìŠ¤íŠ¸.txt` (ê¸°ì¡´)
  - `COA_ì ìš©ì¡°ê±´_í•´ì„_ê°€ì´ë“œ.txt` (ì‹ ê·œ)
  - `ì _ëŒ€ì‘ì „ìˆ _ë¶„ì„_ê°€ì´ë“œ.txt` (ì‹ ê·œ)
  - `ë°©ì±…_ì—°ê³„_ì›ì¹™.txt` (ì‹ ê·œ)
  - `ì§€íœ˜ê´€_ì˜ë„_í•´ì„_ê°€ì´ë“œ.txt` (ì‹ ê·œ)
  - `í™˜ê²½_ì¡°ê±´_í•´ì„_ê°€ì´ë“œ.txt` (ì‹ ê·œ)

## ë‹¤ìŒ ë‹¨ê³„ (ìš°ì„ ìˆœìœ„ 2: ë‹¨ê¸°)

### ðŸ“‹ RAG ì¸ë±ìŠ¤ ìž¬êµ¬ì¶•
**í•„ìš” ìž‘ì—…**:
1. RAG ì¸ë±ìŠ¤ ìž¬êµ¬ì¶• (ì‹ ê·œ ë¬¸ì„œ ë°˜ì˜)
2. ì˜¨í†¨ë¡œì§€ ìž¬ìƒì„± (ì ìš©ì¡°ê±´ í•„ë“œ ë³€ê²½ ë°˜ì˜)
3. í†µí•© í…ŒìŠ¤íŠ¸

**ì‹¤í–‰ ë°©ë²•**:
```bash
# RAG ì¸ë±ìŠ¤ ìž¬êµ¬ì¶•
# UIì—ì„œ "RAG ì¸ë±ìŠ¤ êµ¬ì„±" íƒ­ â†’ "ì¸ë±ìŠ¤ ìž¬êµ¬ì¶•" ë²„íŠ¼ í´ë¦­
# ë˜ëŠ”
python -c "from core_pipeline.orchestrator import Orchestrator; o = Orchestrator(); o.core.rag_manager.build_index(...)"
```

### ðŸ“‹ ì˜¨í†¨ë¡œì§€ ìž¬ìƒì„±
**í•„ìš” ìž‘ì—…**:
1. ì˜¨í†¨ë¡œì§€ ìƒì„± ì‹¤í–‰
2. ì ìš©ì¡°ê±´ í•„ë“œê°€ í‚¤ì›Œë“œ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜ë˜ëŠ”ì§€ í™•ì¸
3. ì ëŒ€ì‘ì „ìˆ , ì—°ê³„ë°©ì±… í•„ë“œê°€ ì œê±°ë˜ì—ˆëŠ”ì§€ í™•ì¸

**ì‹¤í–‰ ë°©ë²•**:
```bash
# UIì—ì„œ "ì˜¨í†¨ë¡œì§€ ìƒì„±" íƒ­ â†’ "ê·¸ëž˜í”„ ìƒì„±" ë²„íŠ¼ í´ë¦­
```

## ë³€ê²½ëœ íŒŒì¼ ëª©ë¡

### ìˆ˜ì •ëœ íŒŒì¼
1. `metadata/schema_registry.yaml`
   - ì ìš©ì¡°ê±´ í•„ë“œ íƒ€ìž… ë³€ê²½
   - ì ëŒ€ì‘ì „ìˆ , ì—°ê³„ë°©ì±… í•„ë“œ ì œê±°

2. `core_pipeline/ontology_manager_enhanced.py`
   - `_extract_keywords_from_condition()` ë©”ì„œë“œ ì¶”ê°€
   - ì ìš©ì¡°ê±´ í•„ë“œ ì²˜ë¦¬ ë¡œì§ ìˆ˜ì •
   - ì ëŒ€ì‘ì „ìˆ  í•„ë“œ ì²˜ë¦¬ ë¡œì§ ì œê±°
   - ì—°ê³„ë°©ì±… ì„œìˆ í˜• í•„ë“œ ì²˜ë¦¬ ë¡œì§ ì œê±°

### ì‹ ê·œ ìƒì„± íŒŒì¼
1. `knowledge/rag_docs/COA_ì ìš©ì¡°ê±´_í•´ì„_ê°€ì´ë“œ.txt`
2. `knowledge/rag_docs/ì _ëŒ€ì‘ì „ìˆ _ë¶„ì„_ê°€ì´ë“œ.txt`
3. `knowledge/rag_docs/ë°©ì±…_ì—°ê³„_ì›ì¹™.txt`
4. `knowledge/rag_docs/ì§€íœ˜ê´€_ì˜ë„_í•´ì„_ê°€ì´ë“œ.txt`
5. `knowledge/rag_docs/í™˜ê²½_ì¡°ê±´_í•´ì„_ê°€ì´ë“œ.txt`

## ê¸°ëŒ€ íš¨ê³¼

### 1. ì˜¨í†¨ë¡œì§€ ë‹¨ìˆœí™”
- ì„œìˆ í˜• í•„ë“œ ì œê±°ë¡œ ì˜¨í†¨ë¡œì§€ í¬ê¸° ê°ì†Œ
- êµ¬ì¡°í™”ëœ ë°ì´í„°ì™€ ì„œìˆ í˜• ì„¤ëª…ì˜ ëª…í™•í•œ ë¶„ë¦¬

### 2. RAG í™œìš©ë„ í–¥ìƒ
- êµë¦¬Â·êµë²” ì§€ì‹ì˜ ì²´ê³„ì  í™œìš©
- LLM ê¸°ë°˜ ê²€ìƒ‰ ë° ì°¸ì¡° ê°€ëŠ¥

### 3. ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ
- êµë¦¬ ë‚´ìš© ë³€ê²½ ì‹œ RAG ë¬¸ì„œë§Œ ìˆ˜ì •
- ì˜¨í†¨ë¡œì§€ ìž¬ìƒì„± ë¶ˆí•„ìš”

### 4. í™•ìž¥ì„± í–¥ìƒ
- ìƒˆë¡œìš´ êµë¦¬ ë¬¸ì„œ ì¶”ê°€ë§Œìœ¼ë¡œ ì§€ì‹ í™•ìž¥
- ì˜¨í†¨ë¡œì§€ ê³¼ë„í•œ ëª¨ë¸ë§ ë°©ì§€

## ì£¼ì˜ì‚¬í•­

### 1. ì˜¨í†¨ë¡œì§€ ìž¬ìƒì„± í•„ìš”
- ì ìš©ì¡°ê±´ í•„ë“œ ë³€ê²½ ì‚¬í•­ ë°˜ì˜ì„ ìœ„í•´ ì˜¨í†¨ë¡œì§€ ìž¬ìƒì„± í•„ìš”
- ê¸°ì¡´ ì˜¨í†¨ë¡œì§€ ì¸ìŠ¤í„´ìŠ¤ì˜ ì ìš©ì¡°ê±´ ê°’ì€ expression í˜•ì‹ìœ¼ë¡œ ë‚¨ì•„ìžˆì„ ìˆ˜ ìžˆìŒ

### 2. RAG ì¸ë±ìŠ¤ ìž¬êµ¬ì¶• í•„ìš”
- ì‹ ê·œ RAG ë¬¸ì„œ ë°˜ì˜ì„ ìœ„í•´ ì¸ë±ìŠ¤ ìž¬êµ¬ì¶• í•„ìš”
- ê¸°ì¡´ ì¸ë±ìŠ¤ì—ëŠ” ì‹ ê·œ ë¬¸ì„œê°€ í¬í•¨ë˜ì§€ ì•ŠìŒ

### 3. í•˜ìœ„ í˜¸í™˜ì„±
- ê¸°ì¡´ Excel ë°ì´í„°ì˜ ì ìš©ì¡°ê±´ í•„ë“œëŠ” expression í˜•ì‹ì¼ ìˆ˜ ìžˆìŒ
- í‚¤ì›Œë“œ ì¶”ì¶œ ë¡œì§ì´ ìžë™ìœ¼ë¡œ ë³€í™˜í•˜ë¯€ë¡œ ë¬¸ì œ ì—†ìŒ

## ê²€ì¦ ë°©ë²•

### 1. ì ìš©ì¡°ê±´ í•„ë“œ ë³€í™˜ í™•ì¸
```python
# ì˜¨í†¨ë¡œì§€ì—ì„œ ì ìš©ì¡°ê±´ í•„ë“œ í™•ì¸
# SPARQL ì¿¼ë¦¬:
# SELECT ?coa ?condition WHERE { ?coa ns:ì ìš©ì¡°ê±´ ?condition }
# ê²°ê³¼ê°€ í‚¤ì›Œë“œ ë¦¬ìŠ¤íŠ¸ì¸ì§€ í™•ì¸
```

### 2. ì ëŒ€ì‘ì „ìˆ  í•„ë“œ ì œê±° í™•ì¸
```python
# ì˜¨í†¨ë¡œì§€ì—ì„œ ì ëŒ€ì‘ì „ìˆ  í•„ë“œ í™•ì¸
# SPARQL ì¿¼ë¦¬:
# SELECT ?coa ?tactic WHERE { ?coa ns:ì ëŒ€ì‘ì „ìˆ  ?tactic }
# ê²°ê³¼ê°€ ì—†ì–´ì•¼ í•¨
```

### 3. RAG ë¬¸ì„œ ê²€ìƒ‰ í™•ì¸
```python
# RAG ê²€ìƒ‰ í…ŒìŠ¤íŠ¸
rag_manager.retrieve("ì  ëŒ€ì‘ì „ìˆ ", top_k=3)
# ì _ëŒ€ì‘ì „ìˆ _ë¶„ì„_ê°€ì´ë“œ.txt ë‚´ìš©ì´ ê²€ìƒ‰ë˜ëŠ”ì§€ í™•ì¸
```

## ì°¸ê³  ë¬¸ì„œ
- `docs/30_Guides/RAG_Doctrine_Improvement_Design.md` - ì „ì²´ ì„¤ê³„ ë¬¸ì„œ



