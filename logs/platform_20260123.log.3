2026-01-23 17:19:04,682 - root - INFO - Logging initialized. File: logs\platform_20260123.log
2026-01-23 17:19:04,682 - root - INFO - [시스템] 디버깅 모드 활성화됨 - 상세 로그가 기록됩니다.
2026-01-23 17:19:04,686 - api.dependencies - INFO - Initializing Orchestrator...
2026-01-23 17:19:04,730 - OntologyManager - INFO - 기존 온톨로지 파일 발견: instances.ttl. 자동 로드를 시도합니다.
2026-01-23 17:19:04,731 - OntologyManager - INFO - 온톨로지 로드 중... (knowledge\ontology\schema.ttl)
2026-01-23 17:19:04,781 - OntologyManager - INFO - 온톨로지 로드 완료. 현재 트리플 수: 624
2026-01-23 17:19:04,784 - OntologyManager - INFO - 온톨로지 로드 중... (knowledge\ontology\instances.ttl)
2026-01-23 17:19:05,481 - OntologyManager - INFO - 온톨로지 로드 완료. 현재 트리플 수: 6613
2026-01-23 17:19:05,521 - OntologyManager - INFO - 'instances.ttl' 기반으로 그래프 초기화 완료. 원본 크기: 6613 triples
2026-01-23 17:19:05,572 - OntologyManager - INFO - 추론 여부 판단 - 원본: 6613 triples, 현재: 6613 triples, 비율: 1.00x
2026-01-23 17:19:05,614 - OntologyManager - INFO - instances_reasoned.ttl이 없어 OWL-RL 추론을 자동 실행합니다...
2026-01-23 17:19:05,651 - core_pipeline.owl_reasoner - INFO - OWL-RL 추론 시작: 원본 트리플 수 = 6613
2026-01-23 17:19:05,900 - core_pipeline.owl_reasoner - INFO - RDFS 추론 실행 중...
2026-01-23 17:19:14,383 - core_pipeline.owl_reasoner - INFO - RDFS 추론 후: 9359 triples (+2746)
2026-01-23 17:19:14,389 - core_pipeline.owl_reasoner - INFO - OWL-RL 추론 실행 중...
2026-01-23 17:19:20,372 - core_pipeline.owl_reasoner - INFO - OWL-RL 추론 완료: 6221개 새로운 트리플 생성 (14.76초)
2026-01-23 17:19:20,373 - core_pipeline.owl_reasoner - INFO -   원본: 6613 → 추론: 12834 triples
2026-01-23 17:19:20,375 - OntologyManager - INFO - OWL-RL 추론 완료: 6221개 새로운 트리플 생성
2026-01-23 17:19:23,631 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-23 17:19:23,644 - LLMManager - INFO - OpenAI API 초기화 및 검증(생성 테스트) 완료 (모델: gpt-4o)
2026-01-23 17:19:35,672 - LLMManager - INFO - 사내망 모델 4개 중 0개 사용 가능
2026-01-23 17:19:35,685 - core_pipeline.relevance_mapper - INFO - 위협 마스터 매핑 로드 완료: 22개 항목
2026-01-23 17:19:35,697 - core_pipeline.relevance_mapper - INFO - 관련성 테이블의 위협 유형을 코드로 정규화했습니다.
2026-01-23 17:19:35,698 - core_pipeline.relevance_mapper - INFO - 유형 레벨 매핑 로드 완료: 77개 매핑
2026-01-23 17:19:35,701 - RuleEngine - INFO - 규칙 파일 로드 완료: 3개 규칙, 3개 가중치
2026-01-23 17:19:46,440 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: C:\POC\COA_Agent_Platform_Ref\models\embedding\rogel-embedding-v2
2026-01-23 17:19:46,955 - api.dependencies - INFO - Initializing COAService...
2026-01-23 17:19:46,967 - core_pipeline.relevance_mapper - INFO - 위협 마스터 매핑 로드 완료: 22개 항목
2026-01-23 17:19:46,981 - core_pipeline.relevance_mapper - INFO - 관련성 테이블의 위협 유형을 코드로 정규화했습니다.
2026-01-23 17:19:46,981 - core_pipeline.relevance_mapper - INFO - 유형 레벨 매핑 로드 완료: 77개 매핑
2026-01-23 17:19:46,986 - api.dependencies - INFO - Global State Initialized.
2026-01-23 17:19:47,029 - core_pipeline.visualization_generator - INFO - 지형셀 데이터 로드 완료 (31개 셀)
2026-01-23 17:20:16,942 - api.routers.coa - INFO - [정황보고] 자연어 변환 완료: 임도교차로, 서부 차단축선, 집결징후
2026-01-23 17:20:16,943 - api.routers.coa - INFO - [정황보고] LLM 생성 시작 - approach_mode: threat_centered
2026-01-23 17:20:16,971 - api.routers.coa - INFO - [정황보고] 자연어 변환 완료: 321고지, 동부 주공축선, 기습공격
2026-01-23 17:20:16,971 - api.routers.coa - INFO - [정황보고] LLM 생성 시작 - approach_mode: threat_centered
2026-01-23 17:20:18,880 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-23 17:20:18,884 - LLMManager - INFO - OpenAI API 사용: gpt-4o
2026-01-23 17:20:18,884 - api.routers.coa - INFO - [정황보고] LLM으로 생성됨 (길이: 148)
2026-01-23 17:20:19,449 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-23 17:20:19,451 - api.routers.coa - INFO - [정황보고] LLM으로 생성됨 (길이: 133)
2026-01-23 17:20:21,708 - DefenseCOAAgent - INFO - 교리 인용 서비스 초기화 완료
2026-01-23 17:20:21,710 - api.routers.agent - INFO - [Agent Progress] 0%: 방책 분석 시작 (유형: defense, offensive, counter_attack, preemptive, deterrence, maneuver, information_ops)
2026-01-23 17:20:21,710 - DefenseCOAAgent - INFO - [STATUS] [0%] 방책 분석 시작 (유형: defense, offensive, counter_attack, preemptive, deterrence, maneuver, information_ops)
2026-01-23 17:20:22,207 - DefenseCOAAgent - INFO - 기존 온톨로지 그래프 사용 (12834개 triples)
2026-01-23 17:20:22,208 - api.routers.agent - INFO - [Agent Progress] 10%: 전술 상황 분석 및 위협 요소 식별 중...
2026-01-23 17:20:22,209 - DefenseCOAAgent - INFO - [STATUS] [10%] 전술 상황 분석 및 위협 요소 식별 중...
2026-01-23 17:20:22,209 - DefenseCOAAgent - INFO - 접근 방식: threat_centered
2026-01-23 17:20:22,210 - DefenseCOAAgent - INFO - selected_situation_info가 있어 우선 사용 (situation_id=THR004는 무시): situation_id=THR004
2026-01-23 17:20:22,211 - DefenseCOAAgent - INFO - 위협ID로 상황 URI 찾음: http://coa-agent-platform.org/ontology#위협상황_THR004
2026-01-23 17:20:22,212 - DefenseCOAAgent - INFO - 관련 엔티티 탐색 완료: 15개 발견
2026-01-23 17:20:22,213 - DefenseCOAAgent - INFO - 관련 엔티티 탐색 완료: 15개 발견
2026-01-23 17:20:22,221 - ReasoningEngine - INFO - 온톨로지에서 임무 유형 추출 성공: 방어
2026-01-23 17:20:22,222 - DefenseCOAAgent - INFO - 온톨로지 기반 임무 유형 보강: 방어
2026-01-23 17:20:22,223 - api.routers.agent - INFO - [Agent Progress] 25%: 임무별 최적 방책 유형 및 대응 전략 수립 중...
2026-01-23 17:20:22,223 - DefenseCOAAgent - INFO - [STATUS] [25%] 임무별 최적 방책 유형 및 대응 전략 수립 중...
2026-01-23 17:20:22,224 - api.routers.agent - INFO - [Agent Progress] 20%: 통합 후보 검색 및 병렬 최적화 수행 중...
2026-01-23 17:20:22,225 - DefenseCOAAgent - INFO - [STATUS] [20%] 통합 후보 검색 및 병렬 최적화 수행 중...
2026-01-23 17:20:22,225 - DefenseCOAAgent - INFO - SPARQL 검색 시작 (위협: THR_TYPE_004, 타입: None)
2026-01-23 17:20:22,226 - DefenseCOAAgent - INFO - SPARQL 검색 타겟 클래스 목록: ['DefenseCOA', 'OffensiveCOA', 'CounterAttackCOA', 'PreemptiveCOA', 'DeterrenceCOA', 'ManeuverCOA', 'InformationOpsCOA']
2026-01-23 17:20:22,245 - DefenseCOAAgent - INFO - 온톨로지 기반 검색 성공: 0건 (SPARQL, 위협: THR_TYPE_004)
2026-01-23 17:20:22,246 - DefenseCOAAgent - INFO - 통합 검색 완료: 총 0개 후보 식별
2026-01-23 17:20:22,250 - DefenseCOAAgent - ERROR - EnhancedDefenseCOAAgent.execute_reasoning 예외 발생: cannot access local variable 'ThreadPoolExecutor' where it is not associated with a value
2026-01-23 17:20:22,252 - DefenseCOAAgent - ERROR - 에러 상세:
Traceback (most recent call last):
  File "C:\POC\COA_Agent_Platform_Ref\agents\defense_coa_agent\logic_defense_enhanced.py", line 445, in execute_reasoning
    with ThreadPoolExecutor(max_workers=max(1, min(len(target_types), 8))) as executor:
         ^^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'ThreadPoolExecutor' where it is not associated with a value
2026-01-23 17:20:22,252 - DefenseCOAAgent - INFO - 에러 발생했으나 selected_situation_info가 있어 최소한의 결과 반환
2026-01-23 17:20:22,253 - api.routers.agent - INFO - COA 1 (에러 발생 - 기본 방책) 점수 추출:
2026-01-23 17:20:22,254 - api.routers.agent - INFO -   - 총점: 0.5
2026-01-23 17:20:22,254 - api.routers.agent - INFO -   - 원본 필드: score=0.5, 최종점수=None, MAUT점수=None
2026-01-23 17:20:22,254 - api.routers.agent - INFO -   - score_breakdown 키들: None
2026-01-23 17:20:22,255 - api.routers.agent - WARNING -   [WARNING] COA 1: score_breakdown이 None입니다!
2026-01-23 17:20:22,255 - api.routers.agent - WARNING -   - COA 1 (ERROR_FALLBACK): score_breakdown이 없습니다!
2026-01-23 17:20:22,256 - api.routers.agent - WARNING -     [WARNING] threat_response_score: breakdown['threat']와 rec['threat_response_score'] 모두 없음, 기본값 0.0 사용
2026-01-23 17:20:22,256 - api.routers.agent - WARNING -     [WARNING] combat_power_score: breakdown['assets']와 rec['combat_power_score'] 모두 없음, 기본값 0.0 사용
2026-01-23 17:20:22,256 - api.routers.agent - WARNING -     [WARNING] mobility_score: breakdown['resources']와 rec['mobility_score'] 모두 없음, 기본값 0.0 사용
2026-01-23 17:20:22,257 - api.routers.agent - WARNING -     [WARNING] constraint_score: breakdown['environment']와 rec 필드 모두 없음, 기본값 0.0 사용
2026-01-23 17:20:22,257 - api.routers.agent - WARNING -     [WARNING] risk_score: rec['risk_score']와 threat 기반 계산 모두 불가, 기본값 0.0 사용
2026-01-23 17:20:22,257 - api.routers.agent - INFO -   - COA 1 (ERROR_FALLBACK) 최종 추출 점수:
2026-01-23 17:20:22,258 - api.routers.agent - INFO -     * threat_response_score=0.0000 (from threat=0.0000, rec.direct=None)
2026-01-23 17:20:22,258 - api.routers.agent - INFO -     * combat_power_score=0.0000 (from assets=0.0000, rec.direct=None)
2026-01-23 17:20:22,258 - api.routers.agent - INFO -     * mobility_score=0.0000 (from resources=0.0000, rec.direct=None)
2026-01-23 17:20:22,259 - api.routers.agent - INFO -     * constraint_score=0.0000 (from environment=0.0000, rec.direct=None, rec.constraint_compliance=None)
2026-01-23 17:20:22,259 - api.routers.agent - INFO -     * risk_score=0.0000 (rec.direct=None, calculated_from_threat=1.0000)
2026-01-23 17:20:22,259 - api.routers.agent - INFO -   - COA 1 최종 추출 점수:
2026-01-23 17:20:22,260 - api.routers.agent - INFO -     * COAScorer breakdown 기반:
2026-01-23 17:20:22,260 - api.routers.agent - INFO -       - threat_response_score=0.0000, combat_power_score=0.0000
2026-01-23 17:20:22,261 - api.routers.agent - INFO -       - mobility_score=0.0000, constraint_score=0.0000, risk_score=0.0000
2026-01-23 17:20:22,261 - api.routers.agent - INFO -     * 적합성/타당성/수용성 (COAScorer breakdown 기반):
2026-01-23 17:20:22,261 - api.routers.agent - INFO -       - suitability_score=0.0000, feasibility_score=0.0000, acceptability_score=0.3000
2026-01-23 17:20:22,262 - api.routers.agent - WARNING -     [WARNING] combat_power_score: breakdown['assets']와 rec['combat_power_score'] 모두 없음, 기본값 0.0 사용
2026-01-23 17:20:22,262 - api.routers.agent - WARNING -     [WARNING] mobility_score: breakdown['resources']와 rec['mobility_score'] 모두 없음, 기본값 0.0 사용
2026-01-23 17:20:22,262 - api.routers.agent - WARNING -     [WARNING] threat_response_score: breakdown['threat']와 rec['threat_response_score'] 모두 없음, 기본값 0.0 사용
2026-01-23 17:20:22,262 - api.routers.agent - WARNING -     [WARNING] constraint_score: breakdown['environment']와 rec 필드 모두 없음, 기본값 0.0 사용
2026-01-23 17:20:22,263 - api.routers.agent - WARNING -     [WARNING] risk_score: rec['risk_score']와 threat 기반 계산 모두 불가, 기본값 0.0 사용
2026-01-23 17:20:22,263 - api.routers.agent - INFO - [시각화 보강] 결과에 axis_states가 없음. 자동 빌드 시도...
2026-01-23 17:20:22,268 - AxisStateBuilder - WARNING - AxisStateBuilder initialized without ontology_manager. METT-C features will be limited.
2026-01-23 17:20:22,283 - core_pipeline.relevance_mapper - INFO - 위협 마스터 매핑 로드 완료: 22개 항목
2026-01-23 17:20:22,301 - core_pipeline.relevance_mapper - INFO - 관련성 테이블의 위협 유형을 코드로 정규화했습니다.
2026-01-23 17:20:22,302 - core_pipeline.relevance_mapper - INFO - 유형 레벨 매핑 로드 완료: 77개 매핑
2026-01-23 17:20:22,307 - AxisStateBuilder - WARNING - AxisStateBuilder initialized without ontology_manager. METT-C features will be limited.
2026-01-23 17:20:22,911 - AxisStateBuilder - INFO - 축선 AXIS01 (동부 주공축선)에 10개 아군 부대 매칭 (총 전투력: 740)
2026-01-23 17:20:22,922 - AxisStateBuilder - INFO - Loaded 11 threat master records
2026-01-23 17:20:22,923 - AxisStateBuilder - INFO - Hydrated 10 threat events with master data
2026-01-23 17:20:22,926 - api.routers.agent - INFO -   - 위협 THR004 기반 축선 빌드 성공: 1개 축선
2026-01-23 17:20:22,981 - core_pipeline.visualization_generator - INFO - 지형셀 데이터 로드 완료 (31개 셀)
2026-01-23 17:20:22,982 - core_pipeline.visualization_generator - INFO - ✅ Resolved axis AXIS01: 3 waypoints
2026-01-23 17:20:22,983 - api.routers.agent - INFO - [시각화 데이터 생성] COA ERROR_FALLBACK: unit_positions가 없거나 비어있음, 재생성 시작
2026-01-23 17:20:22,983 - api.routers.agent - INFO -   - unit_positions 상태: None
2026-01-23 17:20:22,985 - api.routers.agent - INFO -   - participating_units: []
2026-01-23 17:20:22,985 - api.routers.agent - INFO -   - participating_units 개수: 0
2026-01-23 17:20:22,990 - AxisStateBuilder - WARNING - AxisStateBuilder initialized without ontology_manager. METT-C features will be limited.
2026-01-23 17:20:23,010 - core_pipeline.relevance_mapper - INFO - 위협 마스터 매핑 로드 완료: 22개 항목
2026-01-23 17:20:23,036 - core_pipeline.relevance_mapper - INFO - 관련성 테이블의 위협 유형을 코드로 정규화했습니다.
2026-01-23 17:20:23,036 - core_pipeline.relevance_mapper - INFO - 유형 레벨 매핑 로드 완료: 77개 매핑
2026-01-23 17:20:23,102 - api.routers.agent - INFO -   - 조회된 부대 수: 0
2026-01-23 17:20:23,103 - api.routers.agent - INFO -   - 생성 완료: features 개수 = 0
2026-01-23 17:20:23,104 - api.routers.agent - INFO -   - COA ERROR_FALLBACK: 축선 ID 없음, 'AXIS01'로 폴백 적용
2026-01-23 17:20:23,130 - core_pipeline.visualization_generator - INFO - ✅ Resolved axis AXIS01: 3 waypoints
2026-01-23 17:20:23,130 - core_pipeline.visualization_generator - INFO - No unit positions for ERROR_FALLBACK, using axis AXIS01 start point.
2026-01-23 17:20:23,131 - api.routers.agent - INFO -   - 작전 경로 생성 완료: waypoints 개수 = 3
2026-01-23 17:20:23,131 - api.routers.agent - INFO -   - 작전 영역 생성 완료
