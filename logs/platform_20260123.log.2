2026-01-23 17:52:28,323 - root - INFO - Logging initialized. File: logs\platform_20260123.log
2026-01-23 17:52:28,325 - root - INFO - [시스템] 디버깅 모드 활성화됨 - 상세 로그가 기록됩니다.
2026-01-23 17:52:28,371 - api.dependencies - INFO - Initializing Orchestrator...
2026-01-23 17:52:28,732 - OntologyManager - INFO - 기존 온톨로지 파일 발견: instances.ttl. 자동 로드를 시도합니다.
2026-01-23 17:52:28,785 - OntologyManager - INFO - 온톨로지 로드 중... (knowledge\ontology\schema.ttl)
2026-01-23 17:52:29,077 - OntologyManager - INFO - 온톨로지 로드 완료. 현재 트리플 수: 624
2026-01-23 17:52:29,100 - OntologyManager - INFO - 온톨로지 로드 중... (knowledge\ontology\instances.ttl)
2026-01-23 17:52:30,038 - OntologyManager - INFO - 온톨로지 로드 완료. 현재 트리플 수: 6613
2026-01-23 17:52:30,113 - OntologyManager - INFO - 'instances.ttl' 기반으로 그래프 초기화 완료. 원본 크기: 6613 triples
2026-01-23 17:52:30,169 - OntologyManager - INFO - 추론 여부 판단 - 원본: 6613 triples, 현재: 6613 triples, 비율: 1.00x
2026-01-23 17:52:30,308 - OntologyManager - INFO - instances_reasoned.ttl이 없어 OWL-RL 추론을 자동 실행합니다...
2026-01-23 17:52:30,354 - core_pipeline.owl_reasoner - INFO - OWL-RL 추론 시작: 원본 트리플 수 = 6613
2026-01-23 17:52:30,626 - core_pipeline.owl_reasoner - INFO - RDFS 추론 실행 중...
2026-01-23 17:52:35,013 - core_pipeline.owl_reasoner - INFO - RDFS 추론 후: 9359 triples (+2746)
2026-01-23 17:52:35,014 - core_pipeline.owl_reasoner - INFO - OWL-RL 추론 실행 중...
2026-01-23 17:52:40,862 - core_pipeline.owl_reasoner - INFO - OWL-RL 추론 완료: 6221개 새로운 트리플 생성 (10.55초)
2026-01-23 17:52:40,863 - core_pipeline.owl_reasoner - INFO -   원본: 6613 → 추론: 12834 triples
2026-01-23 17:52:40,865 - OntologyManager - INFO - OWL-RL 추론 완료: 6221개 새로운 트리플 생성
2026-01-23 17:52:44,017 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-23 17:52:44,030 - LLMManager - INFO - OpenAI API 초기화 및 검증(생성 테스트) 완료 (모델: gpt-4o)
2026-01-23 17:52:56,065 - LLMManager - INFO - 사내망 모델 4개 중 0개 사용 가능
2026-01-23 17:52:56,143 - core_pipeline.relevance_mapper - INFO - 위협 마스터 매핑 로드 완료: 22개 항목
2026-01-23 17:52:56,224 - core_pipeline.relevance_mapper - INFO - 관련성 테이블의 위협 유형을 코드로 정규화했습니다.
2026-01-23 17:52:56,232 - core_pipeline.relevance_mapper - INFO - 유형 레벨 매핑 로드 완료: 77개 매핑
2026-01-23 17:52:56,298 - RuleEngine - INFO - 규칙 파일 로드 완료: 3개 규칙, 3개 가중치
2026-01-23 17:53:20,086 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: C:\POC\COA_Agent_Platform_Ref\models\embedding\rogel-embedding-v2
2026-01-23 17:53:20,651 - api.dependencies - INFO - Initializing COAService...
2026-01-23 17:53:20,667 - core_pipeline.relevance_mapper - INFO - 위협 마스터 매핑 로드 완료: 22개 항목
2026-01-23 17:53:20,682 - core_pipeline.relevance_mapper - INFO - 관련성 테이블의 위협 유형을 코드로 정규화했습니다.
2026-01-23 17:53:20,683 - core_pipeline.relevance_mapper - INFO - 유형 레벨 매핑 로드 완료: 77개 매핑
2026-01-23 17:53:20,689 - api.dependencies - INFO - Global State Initialized.
2026-01-23 17:53:51,131 - core_pipeline.visualization_generator - INFO - 지형셀 데이터 로드 완료 (31개 셀)
2026-01-23 17:54:40,890 - api.routers.coa - INFO - [정황보고] 자연어 변환 완료: 고지245, 동부 예비축선, 공중위협
2026-01-23 17:54:40,890 - api.routers.coa - INFO - [정황보고] LLM 생성 시작 - approach_mode: threat_centered
2026-01-23 17:54:42,734 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-23 17:54:42,736 - LLMManager - INFO - OpenAI API 사용: gpt-4o
2026-01-23 17:54:42,737 - api.routers.coa - INFO - [정황보고] LLM으로 생성됨 (길이: 143)
2026-01-23 17:54:44,271 - DefenseCOAAgent - INFO - 교리 인용 서비스 초기화 완료
2026-01-23 17:54:44,271 - api.routers.agent - INFO - [Agent Progress] 0%: 방책 분석 시작 (유형: defense, offensive, counter_attack, preemptive, deterrence, maneuver, information_ops)
2026-01-23 17:54:44,272 - DefenseCOAAgent - INFO - [STATUS] [0%] 방책 분석 시작 (유형: defense, offensive, counter_attack, preemptive, deterrence, maneuver, information_ops)
2026-01-23 17:54:44,324 - DefenseCOAAgent - INFO - 기존 온톨로지 그래프 사용 (12834개 triples)
2026-01-23 17:54:44,325 - api.routers.agent - INFO - [Agent Progress] 10%: 전술 상황 분석 및 위협 요소 식별 중...
2026-01-23 17:54:44,325 - DefenseCOAAgent - INFO - [STATUS] [10%] 전술 상황 분석 및 위협 요소 식별 중...
2026-01-23 17:54:44,326 - DefenseCOAAgent - INFO - 접근 방식: threat_centered
2026-01-23 17:54:44,326 - DefenseCOAAgent - INFO - selected_situation_info가 있어 우선 사용 (situation_id=THR006는 무시): situation_id=THR006
2026-01-23 17:54:44,327 - DefenseCOAAgent - INFO - 위협ID로 상황 URI 찾음: http://coa-agent-platform.org/ontology#위협상황_THR006
2026-01-23 17:54:44,327 - DefenseCOAAgent - INFO - 관련 엔티티 탐색 완료: 16개 발견
2026-01-23 17:54:44,327 - DefenseCOAAgent - INFO - 관련 엔티티 탐색 완료: 16개 발견
2026-01-23 17:54:44,336 - ReasoningEngine - INFO - 온톨로지에서 임무 유형 추출 성공: 기만
2026-01-23 17:54:44,337 - DefenseCOAAgent - INFO - 온톨로지 기반 임무 유형 보강: 기만
2026-01-23 17:54:44,337 - api.routers.agent - INFO - [Agent Progress] 25%: 임무별 최적 방책 유형 및 대응 전략 수립 중...
2026-01-23 17:54:44,337 - DefenseCOAAgent - INFO - [STATUS] [25%] 임무별 최적 방책 유형 및 대응 전략 수립 중...
2026-01-23 17:54:44,338 - api.routers.agent - INFO - [Agent Progress] 20%: 통합 후보 검색 및 병렬 최적화 수행 중...
2026-01-23 17:54:44,338 - DefenseCOAAgent - INFO - [STATUS] [20%] 통합 후보 검색 및 병렬 최적화 수행 중...
2026-01-23 17:54:44,339 - DefenseCOAAgent - INFO - SPARQL 검색 시작 (위협: THR_TYPE_006, 타입: None)
2026-01-23 17:54:44,339 - DefenseCOAAgent - INFO - SPARQL 검색 타겟 클래스 목록: ['DefenseCOA', 'OffensiveCOA', 'CounterAttackCOA', 'PreemptiveCOA', 'DeterrenceCOA', 'ManeuverCOA', 'InformationOpsCOA']
2026-01-23 17:54:44,355 - DefenseCOAAgent - INFO - 온톨로지 기반 검색 성공: 0건 (SPARQL, 위협: THR_TYPE_006)
2026-01-23 17:54:44,355 - DefenseCOAAgent - INFO - 통합 검색 완료: 총 0개 후보 식별
2026-01-23 17:54:44,359 - DefenseCOAAgent - ERROR - EnhancedDefenseCOAAgent.execute_reasoning 예외 발생: cannot access local variable 'ThreadPoolExecutor' where it is not associated with a value
2026-01-23 17:54:44,359 - DefenseCOAAgent - ERROR - 에러 상세:
Traceback (most recent call last):
  File "C:\POC\COA_Agent_Platform_Ref\agents\defense_coa_agent\logic_defense_enhanced.py", line 445, in execute_reasoning
    with ThreadPoolExecutor(max_workers=max(1, min(len(target_types), 8))) as executor:
         ^^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'ThreadPoolExecutor' where it is not associated with a value
2026-01-23 17:54:44,360 - DefenseCOAAgent - INFO - 에러 발생했으나 selected_situation_info가 있어 최소한의 결과 반환
2026-01-23 17:54:44,360 - api.routers.agent - INFO - COA 1 (에러 발생 - 기본 방책) 점수 추출:
2026-01-23 17:54:44,360 - api.routers.agent - INFO -   - 총점: 0.5
2026-01-23 17:54:44,360 - api.routers.agent - INFO -   - 원본 필드: score=0.5, 최종점수=None, MAUT점수=None
2026-01-23 17:54:44,361 - api.routers.agent - INFO -   - score_breakdown 키들: None
2026-01-23 17:54:44,361 - api.routers.agent - WARNING -   [WARNING] COA 1: score_breakdown이 None입니다!
2026-01-23 17:54:44,362 - api.routers.agent - WARNING -   - COA 1 (ERROR_FALLBACK): score_breakdown이 없습니다!
2026-01-23 17:54:44,362 - api.routers.agent - WARNING -     [WARNING] threat_response_score: breakdown['threat']와 rec['threat_response_score'] 모두 없음, 기본값 0.0 사용
2026-01-23 17:54:44,362 - api.routers.agent - WARNING -     [WARNING] combat_power_score: breakdown['assets']와 rec['combat_power_score'] 모두 없음, 기본값 0.0 사용
2026-01-23 17:54:44,362 - api.routers.agent - WARNING -     [WARNING] mobility_score: breakdown['resources']와 rec['mobility_score'] 모두 없음, 기본값 0.0 사용
2026-01-23 17:54:44,363 - api.routers.agent - WARNING -     [WARNING] constraint_score: breakdown['environment']와 rec 필드 모두 없음, 기본값 0.0 사용
2026-01-23 17:54:44,363 - api.routers.agent - WARNING -     [WARNING] risk_score: rec['risk_score']와 threat 기반 계산 모두 불가, 기본값 0.0 사용
2026-01-23 17:54:44,363 - api.routers.agent - INFO -   - COA 1 (ERROR_FALLBACK) 최종 추출 점수:
2026-01-23 17:54:44,364 - api.routers.agent - INFO -     * threat_response_score=0.0000 (from threat=0.0000, rec.direct=None)
2026-01-23 17:54:44,364 - api.routers.agent - INFO -     * combat_power_score=0.0000 (from assets=0.0000, rec.direct=None)
2026-01-23 17:54:44,364 - api.routers.agent - INFO -     * mobility_score=0.0000 (from resources=0.0000, rec.direct=None)
2026-01-23 17:54:44,364 - api.routers.agent - INFO -     * constraint_score=0.0000 (from environment=0.0000, rec.direct=None, rec.constraint_compliance=None)
2026-01-23 17:54:44,364 - api.routers.agent - INFO -     * risk_score=0.0000 (rec.direct=None, calculated_from_threat=1.0000)
2026-01-23 17:54:44,364 - api.routers.agent - INFO -   - COA 1 최종 추출 점수:
2026-01-23 17:54:44,364 - api.routers.agent - INFO -     * COAScorer breakdown 기반:
2026-01-23 17:54:44,365 - api.routers.agent - INFO -       - threat_response_score=0.0000, combat_power_score=0.0000
2026-01-23 17:54:44,365 - api.routers.agent - INFO -       - mobility_score=0.0000, constraint_score=0.0000, risk_score=0.0000
2026-01-23 17:54:44,365 - api.routers.agent - INFO -     * 적합성/타당성/수용성 (COAScorer breakdown 기반):
2026-01-23 17:54:44,365 - api.routers.agent - INFO -       - suitability_score=0.0000, feasibility_score=0.0000, acceptability_score=0.3000
2026-01-23 17:54:44,366 - api.routers.agent - WARNING -     [WARNING] combat_power_score: breakdown['assets']와 rec['combat_power_score'] 모두 없음, 기본값 0.0 사용
2026-01-23 17:54:44,366 - api.routers.agent - WARNING -     [WARNING] mobility_score: breakdown['resources']와 rec['mobility_score'] 모두 없음, 기본값 0.0 사용
2026-01-23 17:54:44,366 - api.routers.agent - WARNING -     [WARNING] threat_response_score: breakdown['threat']와 rec['threat_response_score'] 모두 없음, 기본값 0.0 사용
2026-01-23 17:54:44,367 - api.routers.agent - WARNING -     [WARNING] constraint_score: breakdown['environment']와 rec 필드 모두 없음, 기본값 0.0 사용
2026-01-23 17:54:44,367 - api.routers.agent - WARNING -     [WARNING] risk_score: rec['risk_score']와 threat 기반 계산 모두 불가, 기본값 0.0 사용
2026-01-23 17:54:44,367 - api.routers.agent - INFO - [시각화 보강] 결과에 axis_states가 없음. 자동 빌드 시도...
2026-01-23 17:54:44,370 - AxisStateBuilder - WARNING - AxisStateBuilder initialized without ontology_manager. METT-C features will be limited.
2026-01-23 17:54:44,383 - core_pipeline.relevance_mapper - INFO - 위협 마스터 매핑 로드 완료: 22개 항목
2026-01-23 17:54:44,397 - core_pipeline.relevance_mapper - INFO - 관련성 테이블의 위협 유형을 코드로 정규화했습니다.
2026-01-23 17:54:44,397 - core_pipeline.relevance_mapper - INFO - 유형 레벨 매핑 로드 완료: 77개 매핑
2026-01-23 17:54:44,402 - AxisStateBuilder - WARNING - AxisStateBuilder initialized without ontology_manager. METT-C features will be limited.
2026-01-23 17:54:44,793 - AxisStateBuilder - INFO - 축선 AXIS05 (동부 예비축선)에 6개 아군 부대 매칭 (총 전투력: 410)
2026-01-23 17:54:44,799 - AxisStateBuilder - INFO - Loaded 11 threat master records
2026-01-23 17:54:44,800 - AxisStateBuilder - INFO - Hydrated 10 threat events with master data
2026-01-23 17:54:44,802 - api.routers.agent - INFO -   - 위협 THR006 기반 축선 빌드 성공: 1개 축선
2026-01-23 17:54:44,827 - core_pipeline.visualization_generator - INFO - 지형셀 데이터 로드 완료 (31개 셀)
2026-01-23 17:54:44,827 - core_pipeline.visualization_generator - INFO - ✅ Resolved axis AXIS05: 2 waypoints
2026-01-23 17:54:44,828 - api.routers.agent - INFO - [시각화 데이터 생성] COA ERROR_FALLBACK: unit_positions가 없거나 비어있음, 재생성 시작
2026-01-23 17:54:44,828 - api.routers.agent - INFO -   - unit_positions 상태: None
2026-01-23 17:54:44,828 - api.routers.agent - INFO -   - participating_units: []
2026-01-23 17:54:44,828 - api.routers.agent - INFO -   - participating_units 개수: 0
2026-01-23 17:54:44,832 - AxisStateBuilder - WARNING - AxisStateBuilder initialized without ontology_manager. METT-C features will be limited.
2026-01-23 17:54:44,841 - core_pipeline.relevance_mapper - INFO - 위협 마스터 매핑 로드 완료: 22개 항목
2026-01-23 17:54:44,858 - core_pipeline.relevance_mapper - INFO - 관련성 테이블의 위협 유형을 코드로 정규화했습니다.
2026-01-23 17:54:44,859 - core_pipeline.relevance_mapper - INFO - 유형 레벨 매핑 로드 완료: 77개 매핑
2026-01-23 17:54:44,887 - api.routers.agent - INFO -   - 조회된 부대 수: 0
2026-01-23 17:54:44,888 - api.routers.agent - INFO -   - 생성 완료: features 개수 = 0
2026-01-23 17:54:44,888 - api.routers.agent - INFO -   - COA ERROR_FALLBACK: 축선 ID 없음, 'AXIS05'로 폴백 적용
2026-01-23 17:54:44,900 - core_pipeline.visualization_generator - INFO - ✅ Resolved axis AXIS05: 2 waypoints
2026-01-23 17:54:44,900 - core_pipeline.visualization_generator - INFO - No unit positions for ERROR_FALLBACK, using axis AXIS05 start point.
2026-01-23 17:54:44,901 - api.routers.agent - INFO -   - 작전 경로 생성 완료: waypoints 개수 = 3
2026-01-23 17:54:44,901 - api.routers.agent - INFO -   - 작전 영역 생성 완료
